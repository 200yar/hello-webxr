!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=65)}([function(e,t,r){"use strict";var n=r(27);e.exports=Function.prototype.bind||n},function(e,t,r){"use strict";var n=TypeError,o=Object.getOwnPropertyDescriptor?function(){return Object.getOwnPropertyDescriptor(arguments,"callee").get}():function(){throw new n},i=r(31)(),a=Object.getPrototypeOf||function(e){return e.__proto__},s=void 0,u="undefined"==typeof Uint8Array?void 0:a(Uint8Array),l={"$ %Array%":Array,"$ %ArrayBuffer%":"undefined"==typeof ArrayBuffer?void 0:ArrayBuffer,"$ %ArrayBufferPrototype%":"undefined"==typeof ArrayBuffer?void 0:ArrayBuffer.prototype,"$ %ArrayIteratorPrototype%":i?a([][Symbol.iterator]()):void 0,"$ %ArrayPrototype%":Array.prototype,"$ %ArrayProto_entries%":Array.prototype.entries,"$ %ArrayProto_forEach%":Array.prototype.forEach,"$ %ArrayProto_keys%":Array.prototype.keys,"$ %ArrayProto_values%":Array.prototype.values,"$ %AsyncFromSyncIteratorPrototype%":void 0,"$ %AsyncFunction%":void 0,"$ %AsyncFunctionPrototype%":void 0,"$ %AsyncGenerator%":void 0,"$ %AsyncGeneratorFunction%":void 0,"$ %AsyncGeneratorPrototype%":void 0,"$ %AsyncIteratorPrototype%":s&&i&&Symbol.asyncIterator?s[Symbol.asyncIterator]():void 0,"$ %Atomics%":"undefined"==typeof Atomics?void 0:Atomics,"$ %Boolean%":Boolean,"$ %BooleanPrototype%":Boolean.prototype,"$ %DataView%":"undefined"==typeof DataView?void 0:DataView,"$ %DataViewPrototype%":"undefined"==typeof DataView?void 0:DataView.prototype,"$ %Date%":Date,"$ %DatePrototype%":Date.prototype,"$ %decodeURI%":decodeURI,"$ %decodeURIComponent%":decodeURIComponent,"$ %encodeURI%":encodeURI,"$ %encodeURIComponent%":encodeURIComponent,"$ %Error%":Error,"$ %ErrorPrototype%":Error.prototype,"$ %eval%":eval,"$ %EvalError%":EvalError,"$ %EvalErrorPrototype%":EvalError.prototype,"$ %Float32Array%":"undefined"==typeof Float32Array?void 0:Float32Array,"$ %Float32ArrayPrototype%":"undefined"==typeof Float32Array?void 0:Float32Array.prototype,"$ %Float64Array%":"undefined"==typeof Float64Array?void 0:Float64Array,"$ %Float64ArrayPrototype%":"undefined"==typeof Float64Array?void 0:Float64Array.prototype,"$ %Function%":Function,"$ %FunctionPrototype%":Function.prototype,"$ %Generator%":void 0,"$ %GeneratorFunction%":void 0,"$ %GeneratorPrototype%":void 0,"$ %Int8Array%":"undefined"==typeof Int8Array?void 0:Int8Array,"$ %Int8ArrayPrototype%":"undefined"==typeof Int8Array?void 0:Int8Array.prototype,"$ %Int16Array%":"undefined"==typeof Int16Array?void 0:Int16Array,"$ %Int16ArrayPrototype%":"undefined"==typeof Int16Array?void 0:Int8Array.prototype,"$ %Int32Array%":"undefined"==typeof Int32Array?void 0:Int32Array,"$ %Int32ArrayPrototype%":"undefined"==typeof Int32Array?void 0:Int32Array.prototype,"$ %isFinite%":isFinite,"$ %isNaN%":isNaN,"$ %IteratorPrototype%":i?a(a([][Symbol.iterator]())):void 0,"$ %JSON%":JSON,"$ %JSONParse%":JSON.parse,"$ %Map%":"undefined"==typeof Map?void 0:Map,"$ %MapIteratorPrototype%":"undefined"!=typeof Map&&i?a((new Map)[Symbol.iterator]()):void 0,"$ %MapPrototype%":"undefined"==typeof Map?void 0:Map.prototype,"$ %Math%":Math,"$ %Number%":Number,"$ %NumberPrototype%":Number.prototype,"$ %Object%":Object,"$ %ObjectPrototype%":Object.prototype,"$ %ObjProto_toString%":Object.prototype.toString,"$ %ObjProto_valueOf%":Object.prototype.valueOf,"$ %parseFloat%":parseFloat,"$ %parseInt%":parseInt,"$ %Promise%":"undefined"==typeof Promise?void 0:Promise,"$ %PromisePrototype%":"undefined"==typeof Promise?void 0:Promise.prototype,"$ %PromiseProto_then%":"undefined"==typeof Promise?void 0:Promise.prototype.then,"$ %Promise_all%":"undefined"==typeof Promise?void 0:Promise.all,"$ %Promise_reject%":"undefined"==typeof Promise?void 0:Promise.reject,"$ %Promise_resolve%":"undefined"==typeof Promise?void 0:Promise.resolve,"$ %Proxy%":"undefined"==typeof Proxy?void 0:Proxy,"$ %RangeError%":RangeError,"$ %RangeErrorPrototype%":RangeError.prototype,"$ %ReferenceError%":ReferenceError,"$ %ReferenceErrorPrototype%":ReferenceError.prototype,"$ %Reflect%":"undefined"==typeof Reflect?void 0:Reflect,"$ %RegExp%":RegExp,"$ %RegExpPrototype%":RegExp.prototype,"$ %Set%":"undefined"==typeof Set?void 0:Set,"$ %SetIteratorPrototype%":"undefined"!=typeof Set&&i?a((new Set)[Symbol.iterator]()):void 0,"$ %SetPrototype%":"undefined"==typeof Set?void 0:Set.prototype,"$ %SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?void 0:SharedArrayBuffer,"$ %SharedArrayBufferPrototype%":"undefined"==typeof SharedArrayBuffer?void 0:SharedArrayBuffer.prototype,"$ %String%":String,"$ %StringIteratorPrototype%":i?a(""[Symbol.iterator]()):void 0,"$ %StringPrototype%":String.prototype,"$ %Symbol%":i?Symbol:void 0,"$ %SymbolPrototype%":i?Symbol.prototype:void 0,"$ %SyntaxError%":SyntaxError,"$ %SyntaxErrorPrototype%":SyntaxError.prototype,"$ %ThrowTypeError%":o,"$ %TypedArray%":u,"$ %TypedArrayPrototype%":u?u.prototype:void 0,"$ %TypeError%":n,"$ %TypeErrorPrototype%":n.prototype,"$ %Uint8Array%":"undefined"==typeof Uint8Array?void 0:Uint8Array,"$ %Uint8ArrayPrototype%":"undefined"==typeof Uint8Array?void 0:Uint8Array.prototype,"$ %Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?void 0:Uint8ClampedArray,"$ %Uint8ClampedArrayPrototype%":"undefined"==typeof Uint8ClampedArray?void 0:Uint8ClampedArray.prototype,"$ %Uint16Array%":"undefined"==typeof Uint16Array?void 0:Uint16Array,"$ %Uint16ArrayPrototype%":"undefined"==typeof Uint16Array?void 0:Uint16Array.prototype,"$ %Uint32Array%":"undefined"==typeof Uint32Array?void 0:Uint32Array,"$ %Uint32ArrayPrototype%":"undefined"==typeof Uint32Array?void 0:Uint32Array.prototype,"$ %URIError%":URIError,"$ %URIErrorPrototype%":URIError.prototype,"$ %WeakMap%":"undefined"==typeof WeakMap?void 0:WeakMap,"$ %WeakMapPrototype%":"undefined"==typeof WeakMap?void 0:WeakMap.prototype,"$ %WeakSet%":"undefined"==typeof WeakSet?void 0:WeakSet,"$ %WeakSetPrototype%":"undefined"==typeof WeakSet?void 0:WeakSet.prototype},c=r(0).call(Function.call,String.prototype.replace),p=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,f=/\\(\\)?/g,h=function(e){var t=[];return c(e,p,(function(e,r,n,o){t[t.length]=n?c(o,f,"$1"):r||e})),t},d=function(e,t){var r="$ "+e;if(!(r in l))throw new SyntaxError("intrinsic "+e+" does not exist!");if(void 0===l[r]&&!t)throw new n("intrinsic "+e+" exists, but is not available. Please file an issue!");return l[r]};e.exports=function(e,t){if(arguments.length>1&&"boolean"!=typeof t)throw new TypeError('"allowMissing" argument must be a boolean');var r=h(e);if(0===r.length)return d(e,t);for(var n=d("%"+r[0]+"%",t),o=1;o<r.length;o+=1)null!=n&&(n=n[r[o]]);return n}},function(e,t,r){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var n=r(19),o=r(20),i=r(21);function a(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(a()<t)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=u.prototype:(null===e&&(e=new u(t)),e.length=t),e}function u(e,t,r){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(e,t,r);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return p(this,e)}return l(this,e,t,r)}function l(e,t,r,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,r,n){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");t=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n);u.TYPED_ARRAY_SUPPORT?(e=t).__proto__=u.prototype:e=f(e,t);return e}(e,t,r,n):"string"==typeof t?function(e,t,r){"string"==typeof r&&""!==r||(r="utf8");if(!u.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|d(t,r),o=(e=s(e,n)).write(t,r);o!==n&&(e=e.slice(0,o));return e}(e,t,r):function(e,t){if(u.isBuffer(t)){var r=0|h(t.length);return 0===(e=s(e,r)).length?e:(t.copy(e,0,0,r),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(n=t.length)!=n?s(e,0):f(e,t);if("Buffer"===t.type&&i(t.data))return f(e,t.data)}var n;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function c(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function p(e,t){if(c(t),e=s(e,t<0?0:0|h(t)),!u.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function f(e,t){var r=t.length<0?0:0|h(t.length);e=s(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function h(e){if(e>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|e}function d(e,t){if(u.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return N(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return G(e).length;default:if(n)return N(e).length;t=(""+t).toLowerCase(),n=!0}}function m(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return L(this,t,r);case"utf8":case"utf-8":return S(this,t,r);case"ascii":return A(this,t,r);case"latin1":case"binary":return H(this,t,r);case"base64":return _(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function g(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function v(e,t,r,n,o){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=o?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(o)return-1;r=e.length-1}else if(r<0){if(!o)return-1;r=0}if("string"==typeof t&&(t=u.from(t,n)),u.isBuffer(t))return 0===t.length?-1:y(e,t,r,n,o);if("number"==typeof t)return t&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):y(e,[t],r,n,o);throw new TypeError("val must be string, number or Buffer")}function y(e,t,r,n,o){var i,a=1,s=e.length,u=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;a=2,s/=2,u/=2,r/=2}function l(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(o){var c=-1;for(i=r;i<s;i++)if(l(e,i)===l(t,-1===c?0:i-c)){if(-1===c&&(c=i),i-c+1===u)return c*a}else-1!==c&&(i-=i-c),c=-1}else for(r+u>s&&(r=s-u),i=r;i>=0;i--){for(var p=!0,f=0;f<u;f++)if(l(e,i+f)!==l(t,f)){p=!1;break}if(p)return i}return-1}function E(e,t,r,n){r=Number(r)||0;var o=e.length-r;n?(n=Number(n))>o&&(n=o):n=o;var i=t.length;if(i%2!=0)throw new TypeError("Invalid hex string");n>i/2&&(n=i/2);for(var a=0;a<n;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[r+a]=s}return a}function b(e,t,r,n){return $(N(t,e.length-r),e,r,n)}function T(e,t,r,n){return $(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function w(e,t,r,n){return T(e,t,r,n)}function R(e,t,r,n){return $(G(t),e,r,n)}function x(e,t,r,n){return $(function(e,t){for(var r,n,o,i=[],a=0;a<e.length&&!((t-=2)<0);++a)r=e.charCodeAt(a),n=r>>8,o=r%256,i.push(o),i.push(n);return i}(t,e.length-r),e,r,n)}function _(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function S(e,t,r){r=Math.min(e.length,r);for(var n=[],o=t;o<r;){var i,a,s,u,l=e[o],c=null,p=l>239?4:l>223?3:l>191?2:1;if(o+p<=r)switch(p){case 1:l<128&&(c=l);break;case 2:128==(192&(i=e[o+1]))&&(u=(31&l)<<6|63&i)>127&&(c=u);break;case 3:i=e[o+1],a=e[o+2],128==(192&i)&&128==(192&a)&&(u=(15&l)<<12|(63&i)<<6|63&a)>2047&&(u<55296||u>57343)&&(c=u);break;case 4:i=e[o+1],a=e[o+2],s=e[o+3],128==(192&i)&&128==(192&a)&&128==(192&s)&&(u=(15&l)<<18|(63&i)<<12|(63&a)<<6|63&s)>65535&&u<1114112&&(c=u)}null===c?(c=65533,p=1):c>65535&&(c-=65536,n.push(c>>>10&1023|55296),c=56320|1023&c),n.push(c),o+=p}return function(e){var t=e.length;if(t<=M)return String.fromCharCode.apply(String,e);var r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=M));return r}(n)}t.Buffer=u,t.SlowBuffer=function(e){+e!=e&&(e=0);return u.alloc(+e)},t.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=a(),u.poolSize=8192,u._augment=function(e){return e.__proto__=u.prototype,e},u.from=function(e,t,r){return l(null,e,t,r)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(e,t,r){return function(e,t,r,n){return c(t),t<=0?s(e,t):void 0!==r?"string"==typeof n?s(e,t).fill(r,n):s(e,t).fill(r):s(e,t)}(null,e,t,r)},u.allocUnsafe=function(e){return p(null,e)},u.allocUnsafeSlow=function(e){return p(null,e)},u.isBuffer=function(e){return!(null==e||!e._isBuffer)},u.compare=function(e,t){if(!u.isBuffer(e)||!u.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,n=t.length,o=0,i=Math.min(r,n);o<i;++o)if(e[o]!==t[o]){r=e[o],n=t[o];break}return r<n?-1:n<r?1:0},u.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(e,t){if(!i(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return u.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=u.allocUnsafe(t),o=0;for(r=0;r<e.length;++r){var a=e[r];if(!u.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(n,o),o+=a.length}return n},u.byteLength=d,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},u.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},u.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},u.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?S(this,0,e):m.apply(this,arguments)},u.prototype.equals=function(e){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===u.compare(this,e)},u.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(e+=" ... ")),"<Buffer "+e+">"},u.prototype.compare=function(e,t,r,n,o){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===o&&(o=this.length),t<0||r>e.length||n<0||o>this.length)throw new RangeError("out of range index");if(n>=o&&t>=r)return 0;if(n>=o)return-1;if(t>=r)return 1;if(this===e)return 0;for(var i=(o>>>=0)-(n>>>=0),a=(r>>>=0)-(t>>>=0),s=Math.min(i,a),l=this.slice(n,o),c=e.slice(t,r),p=0;p<s;++p)if(l[p]!==c[p]){i=l[p],a=c[p];break}return i<a?-1:a<i?1:0},u.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},u.prototype.indexOf=function(e,t,r){return v(this,e,t,r,!0)},u.prototype.lastIndexOf=function(e,t,r){return v(this,e,t,r,!1)},u.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var o=this.length-t;if((void 0===r||r>o)&&(r=o),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var i=!1;;)switch(n){case"hex":return E(this,e,t,r);case"utf8":case"utf-8":return b(this,e,t,r);case"ascii":return T(this,e,t,r);case"latin1":case"binary":return w(this,e,t,r);case"base64":return R(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,e,t,r);default:if(i)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),i=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var M=4096;function A(e,t,r){var n="";r=Math.min(e.length,r);for(var o=t;o<r;++o)n+=String.fromCharCode(127&e[o]);return n}function H(e,t,r){var n="";r=Math.min(e.length,r);for(var o=t;o<r;++o)n+=String.fromCharCode(e[o]);return n}function L(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var o="",i=t;i<r;++i)o+=k(e[i]);return o}function P(e,t,r){for(var n=e.slice(t,r),o="",i=0;i<n.length;i+=2)o+=String.fromCharCode(n[i]+256*n[i+1]);return o}function B(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function O(e,t,r,n,o,i){if(!u.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<i)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function I(e,t,r,n){t<0&&(t=65535+t+1);for(var o=0,i=Math.min(e.length-r,2);o<i;++o)e[r+o]=(t&255<<8*(n?o:1-o))>>>8*(n?o:1-o)}function C(e,t,r,n){t<0&&(t=4294967295+t+1);for(var o=0,i=Math.min(e.length-r,4);o<i;++o)e[r+o]=t>>>8*(n?o:3-o)&255}function D(e,t,r,n,o,i){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function j(e,t,r,n,i){return i||D(e,0,r,4),o.write(e,t,r,n,23,4),r+4}function U(e,t,r,n,i){return i||D(e,0,r,8),o.write(e,t,r,n,52,8),r+8}u.prototype.slice=function(e,t){var r,n=this.length;if((e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e),u.TYPED_ARRAY_SUPPORT)(r=this.subarray(e,t)).__proto__=u.prototype;else{var o=t-e;r=new u(o,void 0);for(var i=0;i<o;++i)r[i]=this[i+e]}return r},u.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||B(e,t,this.length);for(var n=this[e],o=1,i=0;++i<t&&(o*=256);)n+=this[e+i]*o;return n},u.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||B(e,t,this.length);for(var n=this[e+--t],o=1;t>0&&(o*=256);)n+=this[e+--t]*o;return n},u.prototype.readUInt8=function(e,t){return t||B(e,1,this.length),this[e]},u.prototype.readUInt16LE=function(e,t){return t||B(e,2,this.length),this[e]|this[e+1]<<8},u.prototype.readUInt16BE=function(e,t){return t||B(e,2,this.length),this[e]<<8|this[e+1]},u.prototype.readUInt32LE=function(e,t){return t||B(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},u.prototype.readUInt32BE=function(e,t){return t||B(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},u.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||B(e,t,this.length);for(var n=this[e],o=1,i=0;++i<t&&(o*=256);)n+=this[e+i]*o;return n>=(o*=128)&&(n-=Math.pow(2,8*t)),n},u.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||B(e,t,this.length);for(var n=t,o=1,i=this[e+--n];n>0&&(o*=256);)i+=this[e+--n]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*t)),i},u.prototype.readInt8=function(e,t){return t||B(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},u.prototype.readInt16LE=function(e,t){t||B(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},u.prototype.readInt16BE=function(e,t){t||B(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},u.prototype.readInt32LE=function(e,t){return t||B(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},u.prototype.readInt32BE=function(e,t){return t||B(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},u.prototype.readFloatLE=function(e,t){return t||B(e,4,this.length),o.read(this,e,!0,23,4)},u.prototype.readFloatBE=function(e,t){return t||B(e,4,this.length),o.read(this,e,!1,23,4)},u.prototype.readDoubleLE=function(e,t){return t||B(e,8,this.length),o.read(this,e,!0,52,8)},u.prototype.readDoubleBE=function(e,t){return t||B(e,8,this.length),o.read(this,e,!1,52,8)},u.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||O(this,e,t,r,Math.pow(2,8*r)-1,0);var o=1,i=0;for(this[t]=255&e;++i<r&&(o*=256);)this[t+i]=e/o&255;return t+r},u.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||O(this,e,t,r,Math.pow(2,8*r)-1,0);var o=r-1,i=1;for(this[t+o]=255&e;--o>=0&&(i*=256);)this[t+o]=e/i&255;return t+r},u.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,1,255,0),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},u.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):I(this,e,t,!0),t+2},u.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):I(this,e,t,!1),t+2},u.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):C(this,e,t,!0),t+4},u.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):C(this,e,t,!1),t+4},u.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t|=0,!n){var o=Math.pow(2,8*r-1);O(this,e,t,r,o-1,-o)}var i=0,a=1,s=0;for(this[t]=255&e;++i<r&&(a*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/a>>0)-s&255;return t+r},u.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t|=0,!n){var o=Math.pow(2,8*r-1);O(this,e,t,r,o-1,-o)}var i=r-1,a=1,s=0;for(this[t+i]=255&e;--i>=0&&(a*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/a>>0)-s&255;return t+r},u.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,1,127,-128),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},u.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):I(this,e,t,!0),t+2},u.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):I(this,e,t,!1),t+2},u.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):C(this,e,t,!0),t+4},u.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):C(this,e,t,!1),t+4},u.prototype.writeFloatLE=function(e,t,r){return j(this,e,t,!0,r)},u.prototype.writeFloatBE=function(e,t,r){return j(this,e,t,!1,r)},u.prototype.writeDoubleLE=function(e,t,r){return U(this,e,t,!0,r)},u.prototype.writeDoubleBE=function(e,t,r){return U(this,e,t,!1,r)},u.prototype.copy=function(e,t,r,n){if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var o,i=n-r;if(this===e&&r<t&&t<n)for(o=i-1;o>=0;--o)e[o+t]=this[o+r];else if(i<1e3||!u.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)e[o+t]=this[o+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+i),t);return i},u.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!u.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var i;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(i=t;i<r;++i)this[i]=e;else{var a=u.isBuffer(e)?e:N(new u(e,n).toString()),s=a.length;for(i=0;i<r-t;++i)this[i+t]=a[i%s]}return this};var F=/[^+\/0-9A-Za-z-_]/g;function k(e){return e<16?"0"+e.toString(16):e.toString(16)}function N(e,t){var r;t=t||1/0;for(var n=e.length,o=null,i=[],a=0;a<n;++a){if((r=e.charCodeAt(a))>55295&&r<57344){if(!o){if(r>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(a+1===n){(t-=3)>-1&&i.push(239,191,189);continue}o=r;continue}if(r<56320){(t-=3)>-1&&i.push(239,191,189),o=r;continue}r=65536+(o-55296<<10|r-56320)}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,r<128){if((t-=1)<0)break;i.push(r)}else if(r<2048){if((t-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function G(e){return n.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(F,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function $(e,t,r,n){for(var o=0;o<n&&!(o+r>=t.length||o>=e.length);++o)t[o+r]=e[o];return o}}).call(this,r(3))},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";var n=r(0);e.exports=n.call(Function.call,Object.prototype.hasOwnProperty)},function(e,t,r){"use strict";var n=Function.prototype.toString,o=/^\s*class\b/,i=function(e){try{var t=n.call(e);return o.test(t)}catch(e){return!1}},a=Object.prototype.toString,s="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag;e.exports=function(e){if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;if("function"==typeof e&&!e.prototype)return!0;if(s)return function(e){try{return!i(e)&&(n.call(e),!0)}catch(e){return!1}}(e);if(i(e))return!1;var t=a.call(e);return"[object Function]"===t||"[object GeneratorFunction]"===t}},function(e,t){e.exports=function(){for(var e={},t=0;t<arguments.length;t++){var n=arguments[t];for(var o in n)r.call(n,o)&&(e[o]=n[o])}return e};var r=Object.prototype.hasOwnProperty},function(e,t,r){"use strict";var n=r(28),o="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),i=Object.prototype.toString,a=Array.prototype.concat,s=Object.defineProperty,u=s&&function(){var e={};try{for(var t in s(e,"x",{enumerable:!1,value:e}),e)return!1;return e.x===e}catch(e){return!1}}(),l=function(e,t,r,n){var o;t in e&&("function"!=typeof(o=n)||"[object Function]"!==i.call(o)||!n())||(u?s(e,t,{configurable:!0,enumerable:!1,value:r,writable:!0}):e[t]=r)},c=function(e,t){var r=arguments.length>2?arguments[2]:{},i=n(t);o&&(i=a.call(i,Object.getOwnPropertySymbols(t)));for(var s=0;s<i.length;s+=1)l(e,i[s],t[i[s]],r[i[s]])};c.supportsDescriptors=!!u,e.exports=c},function(e,t,r){"use strict";var n=Object.prototype.toString;e.exports=function(e){var t=n.call(e),r="[object Arguments]"===t;return r||(r="[object Array]"!==t&&null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Function]"===n.call(e.callee)),r}},function(e,t,r){"use strict";var n=r(0),o=r(30),i=n.call(Function.call,String.prototype.replace),a=/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/,s=/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+$/;e.exports=function(){var e=o.ToString(o.CheckObjectCoercible(this));return i(i(e,a,""),s,"")}},function(e,t,r){"use strict";var n=r(1),o=r(40),i=o(n("String.prototype.indexOf"));e.exports=function(e,t){var r=n(e,!!t);return"function"==typeof r&&i(e,".prototype.")?o(r):r}},function(e,t,r){"use strict";var n=r(9);e.exports=function(){return String.prototype.trim&&"​"==="​".trim()?String.prototype.trim:n}},function(e,t){e.exports=function(e){switch(e){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},function(e,t,r){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var n=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;function a(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach((function(e){n[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var r,s,u=a(e),l=1;l<arguments.length;l++){for(var c in r=Object(arguments[l]))o.call(r,c)&&(u[c]=r[c]);if(n){s=n(r);for(var p=0;p<s.length;p++)i.call(r,s[p])&&(u[s[p]]=r[s[p]])}}return u}},function(e,t){THREE.PointerLockControls=function(e,t){void 0===t&&(console.warn('THREE.PointerLockControls: The second parameter "domElement" is now mandatory.'),t=document.body),this.domElement=t,this.isLocked=!1;var r,n=this,o={type:"change"},i={type:"lock"},a={type:"unlock"},s=new THREE.Euler(0,0,0,"YXZ"),u=Math.PI/2,l=new THREE.Vector3;function c(t){if(!1!==n.isLocked){var r=t.movementX||t.mozMovementX||t.webkitMovementX||0,i=t.movementY||t.mozMovementY||t.webkitMovementY||0;s.setFromQuaternion(e.quaternion),s.y-=.002*r,s.x-=.002*i,s.x=Math.max(-u,Math.min(u,s.x)),e.quaternion.setFromEuler(s),n.dispatchEvent(o)}}function p(){document.pointerLockElement===n.domElement?(n.dispatchEvent(i),n.isLocked=!0):(n.dispatchEvent(a),n.isLocked=!1)}function f(){console.error("THREE.PointerLockControls: Unable to use Pointer Lock API")}this.connect=function(){document.addEventListener("mousemove",c,!1),document.addEventListener("pointerlockchange",p,!1),document.addEventListener("pointerlockerror",f,!1)},this.disconnect=function(){document.removeEventListener("mousemove",c,!1),document.removeEventListener("pointerlockchange",p,!1),document.removeEventListener("pointerlockerror",f,!1)},this.dispose=function(){this.disconnect()},this.getObject=function(){return e},this.getDirection=(r=new THREE.Vector3(0,0,-1),function(t){return t.copy(r).applyQuaternion(e.quaternion)}),this.moveForward=function(t){l.setFromMatrixColumn(e.matrix,0),l.crossVectors(e.up,l),e.position.addScaledVector(l,t)},this.moveRight=function(t){l.setFromMatrixColumn(e.matrix,0),e.position.addScaledVector(l,t)},this.lock=function(){this.domElement.requestPointerLock()},this.unlock=function(){document.exitPointerLock()},this.connect()},THREE.PointerLockControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.PointerLockControls.prototype.constructor=THREE.PointerLockControls},function(e,t){THREE.GLTFLoader=function(){function e(e){THREE.Loader.call(this,e),this.dracoLoader=null,this.ddsLoader=null}function t(){var e={};return{get:function(t){return e[t]},add:function(t,r){e[t]=r},remove:function(t){delete e[t]},removeAll:function(){e={}}}}e.prototype=Object.assign(Object.create(THREE.Loader.prototype),{constructor:e,load:function(e,t,r,n){var o,i=this;o=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:THREE.LoaderUtils.extractUrlBase(e),i.manager.itemStart(e);var a=function(t){n?n(t):console.error(t),i.manager.itemError(e),i.manager.itemEnd(e)},s=new THREE.FileLoader(i.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),"use-credentials"===i.crossOrigin&&s.setWithCredentials(!0),s.load(e,(function(r){try{i.parse(r,o,(function(r){t(r),i.manager.itemEnd(e)}),a)}catch(e){a(e)}}),r,a)},setDRACOLoader:function(e){return this.dracoLoader=e,this},setDDSLoader:function(e){return this.ddsLoader=e,this},parse:function(e,t,s,u){var h,d={};if("string"==typeof e)h=e;else if(THREE.LoaderUtils.decodeText(new Uint8Array(e,0,4))===a){try{d[r.KHR_BINARY_GLTF]=new l(e)}catch(e){return void(u&&u(e))}h=d[r.KHR_BINARY_GLTF].content}else h=THREE.LoaderUtils.decodeText(new Uint8Array(e));var m=JSON.parse(h);if(void 0===m.asset||m.asset.version[0]<2)u&&u(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported. Use LegacyGLTFLoader instead."));else{if(m.extensionsUsed)for(var g=0;g<m.extensionsUsed.length;++g){var v=m.extensionsUsed[g],y=m.extensionsRequired||[];switch(v){case r.KHR_LIGHTS_PUNCTUAL:d[v]=new o(m);break;case r.KHR_MATERIALS_UNLIT:d[v]=new i;break;case r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:d[v]=new f;break;case r.KHR_DRACO_MESH_COMPRESSION:d[v]=new c(m,this.dracoLoader);break;case r.MSFT_TEXTURE_DDS:d[r.MSFT_TEXTURE_DDS]=new n(this.ddsLoader);break;case r.KHR_TEXTURE_TRANSFORM:d[r.KHR_TEXTURE_TRANSFORM]=new p;break;default:y.indexOf(v)>=0&&console.warn('THREE.GLTFLoader: Unknown extension "'+v+'".')}}new F(m,d,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,manager:this.manager}).parse(s,u)}}});var r={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",MSFT_TEXTURE_DDS:"MSFT_texture_dds"};function n(e){if(!e)throw new Error("THREE.GLTFLoader: Attempting to load .dds texture without importing THREE.DDSLoader");this.name=r.MSFT_TEXTURE_DDS,this.ddsLoader=e}function o(e){this.name=r.KHR_LIGHTS_PUNCTUAL;var t=e.extensions&&e.extensions[r.KHR_LIGHTS_PUNCTUAL]||{};this.lightDefs=t.lights||[]}function i(){this.name=r.KHR_MATERIALS_UNLIT}o.prototype.loadLight=function(e){var t,r=this.lightDefs[e],n=new THREE.Color(16777215);void 0!==r.color&&n.fromArray(r.color);var o=void 0!==r.range?r.range:0;switch(r.type){case"directional":(t=new THREE.DirectionalLight(n)).target.position.set(0,0,-1),t.add(t.target);break;case"point":(t=new THREE.PointLight(n)).distance=o;break;case"spot":(t=new THREE.SpotLight(n)).distance=o,r.spot=r.spot||{},r.spot.innerConeAngle=void 0!==r.spot.innerConeAngle?r.spot.innerConeAngle:0,r.spot.outerConeAngle=void 0!==r.spot.outerConeAngle?r.spot.outerConeAngle:Math.PI/4,t.angle=r.spot.outerConeAngle,t.penumbra=1-r.spot.innerConeAngle/r.spot.outerConeAngle,t.target.position.set(0,0,-1),t.add(t.target);break;default:throw new Error('THREE.GLTFLoader: Unexpected light type, "'+r.type+'".')}return t.position.set(0,0,0),t.decay=2,void 0!==r.intensity&&(t.intensity=r.intensity),t.name=r.name||"light_"+e,Promise.resolve(t)},i.prototype.getMaterialType=function(){return THREE.MeshBasicMaterial},i.prototype.extendParams=function(e,t,r){var n=[];e.color=new THREE.Color(1,1,1),e.opacity=1;var o=t.pbrMetallicRoughness;if(o){if(Array.isArray(o.baseColorFactor)){var i=o.baseColorFactor;e.color.fromArray(i),e.opacity=i[3]}void 0!==o.baseColorTexture&&n.push(r.assignTexture(e,"map",o.baseColorTexture))}return Promise.all(n)};var a="glTF",s=12,u={JSON:1313821514,BIN:5130562};function l(e){this.name=r.KHR_BINARY_GLTF,this.content=null,this.body=null;var t=new DataView(e,0,s);if(this.header={magic:THREE.LoaderUtils.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==a)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected. Use LegacyGLTFLoader instead.");for(var n=new DataView(e,s),o=0;o<n.byteLength;){var i=n.getUint32(o,!0);o+=4;var l=n.getUint32(o,!0);if(o+=4,l===u.JSON){var c=new Uint8Array(e,s+o,i);this.content=THREE.LoaderUtils.decodeText(c)}else if(l===u.BIN){var p=s+o;this.body=e.slice(p,p+i)}o+=i}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}function c(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=r.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t}function p(){this.name=r.KHR_TEXTURE_TRANSFORM}function f(){return{name:r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return THREE.ShaderMaterial},extendParams:function(e,t,r){var n=t.extensions[this.name],o=THREE.ShaderLib.standard,i=THREE.UniformsUtils.clone(o.uniforms),a=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),s=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),u=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),l=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),c=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb;","material.specularRoughness = clamp( 1.0 - glossinessFactor, 0.04, 1.0 );","material.specularColor = specularFactor.rgb;"].join("\n"),p=o.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",a).replace("#include <metalnessmap_pars_fragment>",s).replace("#include <roughnessmap_fragment>",u).replace("#include <metalnessmap_fragment>",l).replace("#include <lights_physical_fragment>",c);delete i.roughness,delete i.metalness,delete i.roughnessMap,delete i.metalnessMap,i.specular={value:(new THREE.Color).setHex(1118481)},i.glossiness={value:.5},i.specularMap={value:null},i.glossinessMap={value:null},e.vertexShader=o.vertexShader,e.fragmentShader=p,e.uniforms=i,e.defines={STANDARD:""},e.color=new THREE.Color(1,1,1),e.opacity=1;var f=[];if(Array.isArray(n.diffuseFactor)){var h=n.diffuseFactor;e.color.fromArray(h),e.opacity=h[3]}if(void 0!==n.diffuseTexture&&f.push(r.assignTexture(e,"map",n.diffuseTexture)),e.emissive=new THREE.Color(0,0,0),e.glossiness=void 0!==n.glossinessFactor?n.glossinessFactor:1,e.specular=new THREE.Color(1,1,1),Array.isArray(n.specularFactor)&&e.specular.fromArray(n.specularFactor),void 0!==n.specularGlossinessTexture){var d=n.specularGlossinessTexture;f.push(r.assignTexture(e,"glossinessMap",d)),f.push(r.assignTexture(e,"specularMap",d))}return Promise.all(f)},createMaterial:function(e){var t=new THREE.ShaderMaterial({defines:e.defines,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,uniforms:e.uniforms,fog:!0,lights:!0,opacity:e.opacity,transparent:e.transparent});return t.isGLTFSpecularGlossinessMaterial=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t.extensions.derivatives=!0,t},cloneMaterial:function(e){var t=e.clone();t.isGLTFSpecularGlossinessMaterial=!0;for(var r=this.specularGlossinessParams,n=0,o=r.length;n<o;n++){var i=e[r[n]];t[r[n]]=i&&i.isColor?i.clone():i}return t},refreshUniforms:function(e,t,r,n,o){if(!0===o.isGLTFSpecularGlossinessMaterial){var i,a=o.uniforms,s=o.defines;a.opacity.value=o.opacity,a.diffuse.value.copy(o.color),a.emissive.value.copy(o.emissive).multiplyScalar(o.emissiveIntensity),a.map.value=o.map,a.specularMap.value=o.specularMap,a.alphaMap.value=o.alphaMap,a.lightMap.value=o.lightMap,a.lightMapIntensity.value=o.lightMapIntensity,a.aoMap.value=o.aoMap,a.aoMapIntensity.value=o.aoMapIntensity,o.map?i=o.map:o.specularMap?i=o.specularMap:o.displacementMap?i=o.displacementMap:o.normalMap?i=o.normalMap:o.bumpMap?i=o.bumpMap:o.glossinessMap?i=o.glossinessMap:o.alphaMap?i=o.alphaMap:o.emissiveMap&&(i=o.emissiveMap),void 0!==i&&(i.isWebGLRenderTarget&&(i=i.texture),!0===i.matrixAutoUpdate&&i.updateMatrix(),a.uvTransform.value.copy(i.matrix)),o.envMap&&(a.envMap.value=o.envMap,a.envMapIntensity.value=o.envMapIntensity,a.flipEnvMap.value=o.envMap.isCubeTexture?-1:1,a.reflectivity.value=o.reflectivity,a.refractionRatio.value=o.refractionRatio,a.maxMipLevel.value=e.properties.get(o.envMap).__maxMipLevel),a.specular.value.copy(o.specular),a.glossiness.value=o.glossiness,a.glossinessMap.value=o.glossinessMap,a.emissiveMap.value=o.emissiveMap,a.bumpMap.value=o.bumpMap,a.normalMap.value=o.normalMap,a.displacementMap.value=o.displacementMap,a.displacementScale.value=o.displacementScale,a.displacementBias.value=o.displacementBias,null!==a.glossinessMap.value&&void 0===s.USE_GLOSSINESSMAP&&(s.USE_GLOSSINESSMAP="",s.USE_ROUGHNESSMAP=""),null===a.glossinessMap.value&&void 0!==s.USE_GLOSSINESSMAP&&(delete s.USE_GLOSSINESSMAP,delete s.USE_ROUGHNESSMAP)}}}}function h(e,t,r,n){THREE.Interpolant.call(this,e,t,r,n)}c.prototype.decodePrimitive=function(e,t){var r=this.json,n=this.dracoLoader,o=e.extensions[this.name].bufferView,i=e.extensions[this.name].attributes,a={},s={},u={};for(var l in i){var c=S[l]||l.toLowerCase();a[c]=i[l]}for(l in e.attributes){c=S[l]||l.toLowerCase();if(void 0!==i[l]){var p=r.accessors[e.attributes[l]],f=w[p.componentType];u[c]=f,s[c]=!0===p.normalized}}return t.getDependency("bufferView",o).then((function(e){return new Promise((function(t){n.decodeDracoFile(e,(function(e){for(var r in e.attributes){var n=e.attributes[r],o=s[r];void 0!==o&&(n.normalized=o)}t(e)}),a,u)}))}))},p.prototype.extendTexture=function(e,t){return e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),e.needsUpdate=!0,e},h.prototype=Object.create(THREE.Interpolant.prototype),h.prototype.constructor=h,h.prototype.copySampleValue_=function(e){for(var t=this.resultBuffer,r=this.sampleValues,n=this.valueSize,o=e*n*3+n,i=0;i!==n;i++)t[i]=r[o+i];return t},h.prototype.beforeStart_=h.prototype.copySampleValue_,h.prototype.afterEnd_=h.prototype.copySampleValue_,h.prototype.interpolate_=function(e,t,r,n){for(var o=this.resultBuffer,i=this.sampleValues,a=this.valueSize,s=2*a,u=3*a,l=n-t,c=(r-t)/l,p=c*c,f=p*c,h=e*u,d=h-u,m=-2*f+3*p,g=f-p,v=1-m,y=g-p+c,E=0;E!==a;E++){var b=i[d+E+a],T=i[d+E+s]*l,w=i[h+E+a],R=i[h+E]*l;o[E]=v*b+y*T+m*w+g*R}return o};var d,m=0,g=1,v=2,y=3,E=4,b=5,T=6,w={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},R={9728:THREE.NearestFilter,9729:THREE.LinearFilter,9984:THREE.NearestMipmapNearestFilter,9985:THREE.LinearMipmapNearestFilter,9986:THREE.NearestMipmapLinearFilter,9987:THREE.LinearMipmapLinearFilter},x={33071:THREE.ClampToEdgeWrapping,33648:THREE.MirroredRepeatWrapping,10497:THREE.RepeatWrapping},_={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},S={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},M={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},A={CUBICSPLINE:void 0,LINEAR:THREE.InterpolateLinear,STEP:THREE.InterpolateDiscrete},H="OPAQUE",L="MASK",P="BLEND",B={"image/png":THREE.RGBAFormat,"image/jpeg":THREE.RGBFormat};function O(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)?e:/^data:.*,.*$/i.test(e)?e:/^blob:.*$/i.test(e)?e:t+e)}function I(e,t,r){for(var n in r.extensions)void 0===e[n]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[n]=r.extensions[n])}function C(e,t){void 0!==t.extras&&("object"==typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function D(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(var r=0,n=t.weights.length;r<n;r++)e.morphTargetInfluences[r]=t.weights[r];if(t.extras&&Array.isArray(t.extras.targetNames)){var o=t.extras.targetNames;if(e.morphTargetInfluences.length===o.length){e.morphTargetDictionary={};for(r=0,n=o.length;r<n;r++)e.morphTargetDictionary[o[r]]=r}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function j(e){for(var t="",r=Object.keys(e).sort(),n=0,o=r.length;n<o;n++)t+=r[n]+":"+e[r[n]]+";";return t}function U(e){if(e.isInterleavedBufferAttribute){for(var t=e.count,r=e.itemSize,n=e.array.slice(0,t*r),o=0,i=0;o<t;++o)n[i++]=e.getX(o),r>=2&&(n[i++]=e.getY(o)),r>=3&&(n[i++]=e.getZ(o)),r>=4&&(n[i++]=e.getW(o));return new THREE.BufferAttribute(n,r,e.normalized)}return e.clone()}function F(e,r,n){this.json=e||{},this.extensions=r||{},this.options=n||{},this.cache=new t,this.primitiveCache={},this.textureLoader=new THREE.TextureLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new THREE.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}function k(e,t,r){var n=t.attributes,o=[];function i(t,n){return r.getDependency("accessor",t).then((function(t){e.addAttribute(n,t)}))}for(var a in n){var s=S[a]||a.toLowerCase();s in e.attributes||o.push(i(n[a],s))}if(void 0!==t.indices&&!e.index){var u=r.getDependency("accessor",t.indices).then((function(t){e.setIndex(t)}));o.push(u)}return C(e,t),Promise.all(o).then((function(){return void 0!==t.targets?function(e,t,r){for(var n=!1,o=!1,i=0,a=t.length;i<a;i++){if(void 0!==(l=t[i]).POSITION&&(n=!0),void 0!==l.NORMAL&&(o=!0),n&&o)break}if(!n&&!o)return Promise.resolve(e);var s=[],u=[];for(i=0,a=t.length;i<a;i++){var l=t[i];if(n){var c=void 0!==l.POSITION?r.getDependency("accessor",l.POSITION):e.attributes.position;s.push(c)}if(o){c=void 0!==l.NORMAL?r.getDependency("accessor",l.NORMAL):e.attributes.normal;u.push(c)}}return Promise.all([Promise.all(s),Promise.all(u)]).then((function(r){for(var i=r[0],a=r[1],s=0,u=i.length;s<u;s++)e.attributes.position!==i[s]&&(i[s]=U(i[s]));for(s=0,u=a.length;s<u;s++)e.attributes.normal!==a[s]&&(a[s]=U(a[s]));for(s=0,u=t.length;s<u;s++){var l=t[s],c="morphTarget"+s;if(n&&void 0!==l.POSITION){var p=i[s];p.name=c;for(var f=e.attributes.position,h=0,d=p.count;h<d;h++)p.setXYZ(h,p.getX(h)+f.getX(h),p.getY(h)+f.getY(h),p.getZ(h)+f.getZ(h))}if(o&&void 0!==l.NORMAL){var m=a[s];m.name=c;var g=e.attributes.normal;for(h=0,d=m.count;h<d;h++)m.setXYZ(h,m.getX(h)+g.getX(h),m.getY(h)+g.getY(h),m.getZ(h)+g.getZ(h))}}return n&&(e.morphAttributes.position=i),o&&(e.morphAttributes.normal=a),e}))}(e,t.targets,r):e}))}return F.prototype.parse=function(e,t){var r=this,n=this.json,o=this.extensions;this.cache.removeAll(),this.markDefs(),Promise.all([this.getDependencies("scene"),this.getDependencies("animation"),this.getDependencies("camera")]).then((function(t){var i={scene:t[0][n.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:n.asset,parser:r,userData:{}};I(o,i,n),C(i,n),e(i)})).catch(t)},F.prototype.markDefs=function(){for(var e=this.json.nodes||[],t=this.json.skins||[],r=this.json.meshes||[],n={},o={},i=0,a=t.length;i<a;i++)for(var s=t[i].joints,u=0,l=s.length;u<l;u++)e[s[u]].isBone=!0;for(var c=0,p=e.length;c<p;c++){var f=e[c];void 0!==f.mesh&&(void 0===n[f.mesh]&&(n[f.mesh]=o[f.mesh]=0),n[f.mesh]++,void 0!==f.skin&&(r[f.mesh].isSkinnedMesh=!0))}this.json.meshReferences=n,this.json.meshUses=o},F.prototype.getDependency=function(e,t){var n=e+":"+t,o=this.cache.get(n);if(!o){switch(e){case"scene":o=this.loadScene(t);break;case"node":o=this.loadNode(t);break;case"mesh":o=this.loadMesh(t);break;case"accessor":o=this.loadAccessor(t);break;case"bufferView":o=this.loadBufferView(t);break;case"buffer":o=this.loadBuffer(t);break;case"material":o=this.loadMaterial(t);break;case"texture":o=this.loadTexture(t);break;case"skin":o=this.loadSkin(t);break;case"animation":o=this.loadAnimation(t);break;case"camera":o=this.loadCamera(t);break;case"light":o=this.extensions[r.KHR_LIGHTS_PUNCTUAL].loadLight(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(n,o)}return o},F.prototype.getDependencies=function(e){var t=this.cache.get(e);if(!t){var r=this,n=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(n.map((function(t,n){return r.getDependency(e,n)}))),this.cache.add(e,t)}return t},F.prototype.loadBuffer=function(e){var t=this.json.buffers[e],n=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[r.KHR_BINARY_GLTF].body);var o=this.options;return new Promise((function(e,r){n.load(O(t.uri,o.path),e,void 0,(function(){r(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))}))}))},F.prototype.loadBufferView=function(e){var t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then((function(e){var r=t.byteLength||0,n=t.byteOffset||0;return e.slice(n,n+r)}))},F.prototype.loadAccessor=function(e){var t=this,r=this.json,n=this.json.accessors[e];if(void 0===n.bufferView&&void 0===n.sparse)return Promise.resolve(null);var o=[];return void 0!==n.bufferView?o.push(this.getDependency("bufferView",n.bufferView)):o.push(null),void 0!==n.sparse&&(o.push(this.getDependency("bufferView",n.sparse.indices.bufferView)),o.push(this.getDependency("bufferView",n.sparse.values.bufferView))),Promise.all(o).then((function(e){var o,i,a=e[0],s=_[n.type],u=w[n.componentType],l=u.BYTES_PER_ELEMENT,c=l*s,p=n.byteOffset||0,f=void 0!==n.bufferView?r.bufferViews[n.bufferView].byteStride:void 0,h=!0===n.normalized;if(f&&f!==c){var d=Math.floor(p/f),m="InterleavedBuffer:"+n.bufferView+":"+n.componentType+":"+d+":"+n.count,g=t.cache.get(m);g||(o=new u(a,d*f,n.count*f/l),g=new THREE.InterleavedBuffer(o,f/l),t.cache.add(m,g)),i=new THREE.InterleavedBufferAttribute(g,s,p%f/l,h)}else o=null===a?new u(n.count*s):new u(a,p,n.count*s),i=new THREE.BufferAttribute(o,s,h);if(void 0!==n.sparse){var v=_.SCALAR,y=w[n.sparse.indices.componentType],E=n.sparse.indices.byteOffset||0,b=n.sparse.values.byteOffset||0,T=new y(e[1],E,n.sparse.count*v),R=new u(e[2],b,n.sparse.count*s);null!==a&&(i=new THREE.BufferAttribute(i.array.slice(),i.itemSize,i.normalized));for(var x=0,S=T.length;x<S;x++){var M=T[x];if(i.setX(M,R[x*s]),s>=2&&i.setY(M,R[x*s+1]),s>=3&&i.setZ(M,R[x*s+2]),s>=4&&i.setW(M,R[x*s+3]),s>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return i}))},F.prototype.loadTexture=function(e){var t,n=this,o=this.json,i=this.options,a=this.textureLoader,s=window.URL||window.webkitURL,u=o.textures[e],l=u.extensions||{},c=(t=l[r.MSFT_TEXTURE_DDS]?o.images[l[r.MSFT_TEXTURE_DDS].source]:o.images[u.source]).uri,p=!1;return void 0!==t.bufferView&&(c=n.getDependency("bufferView",t.bufferView).then((function(e){p=!0;var r=new Blob([e],{type:t.mimeType});return c=s.createObjectURL(r)}))),Promise.resolve(c).then((function(e){var t=i.manager.getHandler(e);return t||(t=l[r.MSFT_TEXTURE_DDS]?n.extensions[r.MSFT_TEXTURE_DDS].ddsLoader:a),new Promise((function(r,n){t.load(O(e,i.path),r,void 0,n)}))})).then((function(e){!0===p&&s.revokeObjectURL(c),e.flipY=!1,void 0!==u.name&&(e.name=u.name),t.mimeType in B&&(e.format=B[t.mimeType]);var r=(o.samplers||{})[u.sampler]||{};return e.magFilter=R[r.magFilter]||THREE.LinearFilter,e.minFilter=R[r.minFilter]||THREE.LinearMipmapLinearFilter,e.wrapS=x[r.wrapS]||THREE.RepeatWrapping,e.wrapT=x[r.wrapT]||THREE.RepeatWrapping,e}))},F.prototype.assignTexture=function(e,t,n){var o=this;return this.getDependency("texture",n.index).then((function(i){if(!i.isCompressedTexture)switch(t){case"aoMap":case"emissiveMap":case"metalnessMap":case"normalMap":case"roughnessMap":i.format=THREE.RGBFormat}if(o.extensions[r.KHR_TEXTURE_TRANSFORM]){var a=void 0!==n.extensions?n.extensions[r.KHR_TEXTURE_TRANSFORM]:void 0;a&&(i=o.extensions[r.KHR_TEXTURE_TRANSFORM].extendTexture(i,a))}e[t]=i}))},F.prototype.assignFinalMaterial=function(e){var t=e.geometry,n=e.material,o=this.extensions,i=void 0!==t.attributes.tangent,a=void 0!==t.attributes.color,s=void 0===t.attributes.normal,u=!0===e.isSkinnedMesh,l=Object.keys(t.morphAttributes).length>0,c=l&&void 0!==t.morphAttributes.normal;if(e.isPoints){var p="PointsMaterial:"+n.uuid,f=this.cache.get(p);f||(f=new THREE.PointsMaterial,THREE.Material.prototype.copy.call(f,n),f.color.copy(n.color),f.map=n.map,f.lights=!1,f.sizeAttenuation=!1,this.cache.add(p,f)),n=f}else if(e.isLine){p="LineBasicMaterial:"+n.uuid;var h=this.cache.get(p);h||(h=new THREE.LineBasicMaterial,THREE.Material.prototype.copy.call(h,n),h.color.copy(n.color),h.lights=!1,this.cache.add(p,h)),n=h}if(i||a||s||u||l){p="ClonedMaterial:"+n.uuid+":";n.isGLTFSpecularGlossinessMaterial&&(p+="specular-glossiness:"),u&&(p+="skinning:"),i&&(p+="vertex-tangents:"),a&&(p+="vertex-colors:"),s&&(p+="flat-shading:"),l&&(p+="morph-targets:"),c&&(p+="morph-normals:");var d=this.cache.get(p);d||(d=n.isGLTFSpecularGlossinessMaterial?o[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].cloneMaterial(n):n.clone(),u&&(d.skinning=!0),i&&(d.vertexTangents=!0),a&&(d.vertexColors=THREE.VertexColors),s&&(d.flatShading=!0),l&&(d.morphTargets=!0),c&&(d.morphNormals=!0),this.cache.add(p,d)),n=d}n.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&(console.log("THREE.GLTFLoader: Duplicating UVs to support aoMap."),t.addAttribute("uv2",new THREE.BufferAttribute(t.attributes.uv.array,2))),n.isGLTFSpecularGlossinessMaterial&&(e.onBeforeRender=o[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].refreshUniforms),e.material=n},F.prototype.loadMaterial=function(e){var t,n=this.json,o=this.extensions,i=n.materials[e],a={},s=i.extensions||{},u=[];if(s[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var l=o[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];t=l.getMaterialType(),u.push(l.extendParams(a,i,this))}else if(s[r.KHR_MATERIALS_UNLIT]){var c=o[r.KHR_MATERIALS_UNLIT];t=c.getMaterialType(),u.push(c.extendParams(a,i,this))}else{t=THREE.MeshStandardMaterial;var p=i.pbrMetallicRoughness||{};if(a.color=new THREE.Color(1,1,1),a.opacity=1,Array.isArray(p.baseColorFactor)){var f=p.baseColorFactor;a.color.fromArray(f),a.opacity=f[3]}void 0!==p.baseColorTexture&&u.push(this.assignTexture(a,"map",p.baseColorTexture)),a.metalness=void 0!==p.metallicFactor?p.metallicFactor:1,a.roughness=void 0!==p.roughnessFactor?p.roughnessFactor:1,void 0!==p.metallicRoughnessTexture&&(u.push(this.assignTexture(a,"metalnessMap",p.metallicRoughnessTexture)),u.push(this.assignTexture(a,"roughnessMap",p.metallicRoughnessTexture)))}!0===i.doubleSided&&(a.side=THREE.DoubleSide);var h=i.alphaMode||H;return h===P?a.transparent=!0:(a.transparent=!1,h===L&&(a.alphaTest=void 0!==i.alphaCutoff?i.alphaCutoff:.5)),void 0!==i.normalTexture&&t!==THREE.MeshBasicMaterial&&(u.push(this.assignTexture(a,"normalMap",i.normalTexture)),a.normalScale=new THREE.Vector2(1,1),void 0!==i.normalTexture.scale&&a.normalScale.set(i.normalTexture.scale,i.normalTexture.scale)),void 0!==i.occlusionTexture&&t!==THREE.MeshBasicMaterial&&(u.push(this.assignTexture(a,"aoMap",i.occlusionTexture)),void 0!==i.occlusionTexture.strength&&(a.aoMapIntensity=i.occlusionTexture.strength)),void 0!==i.emissiveFactor&&t!==THREE.MeshBasicMaterial&&(a.emissive=(new THREE.Color).fromArray(i.emissiveFactor)),void 0!==i.emissiveTexture&&t!==THREE.MeshBasicMaterial&&u.push(this.assignTexture(a,"emissiveMap",i.emissiveTexture)),Promise.all(u).then((function(){var e;return e=t===THREE.ShaderMaterial?o[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(a):new t(a),void 0!==i.name&&(e.name=i.name),e.map&&(e.map.encoding=THREE.sRGBEncoding),e.emissiveMap&&(e.emissiveMap.encoding=THREE.sRGBEncoding),e.specularMap&&(e.specularMap.encoding=THREE.sRGBEncoding),C(e,i),i.extensions&&I(o,e,i),e}))},F.prototype.loadGeometries=function(e){var t=this,n=this.extensions,o=this.primitiveCache;function i(e){return n[r.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then((function(r){return k(r,e,t)}))}for(var a,s,u=[],l=0,c=e.length;l<c;l++){var p,f=e[l],h=(s=void 0,(s=(a=f).extensions&&a.extensions[r.KHR_DRACO_MESH_COMPRESSION])?"draco:"+s.bufferView+":"+s.indices+":"+j(s.attributes):a.indices+":"+j(a.attributes)+":"+a.mode),d=o[h];if(d)u.push(d.promise);else p=f.extensions&&f.extensions[r.KHR_DRACO_MESH_COMPRESSION]?i(f):k(new THREE.BufferGeometry,f,t),o[h]={primitive:f,promise:p},u.push(p)}return Promise.all(u)},F.prototype.loadMesh=function(e){for(var t=this,r=this.json.meshes[e],n=r.primitives,o=[],i=0,a=n.length;i<a;i++){var s=void 0===n[i].material?d=d||new THREE.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:THREE.FrontSide}):this.getDependency("material",n[i].material);o.push(s)}return Promise.all(o).then((function(o){return t.loadGeometries(n).then((function(i){for(var a=[],s=0,u=i.length;s<u;s++){var l,c=i[s],p=n[s],f=o[s];if(p.mode===E||p.mode===b||p.mode===T||void 0===p.mode)!0!==(l=!0===r.isSkinnedMesh?new THREE.SkinnedMesh(c,f):new THREE.Mesh(c,f)).isSkinnedMesh||l.geometry.attributes.skinWeight.normalized||l.normalizeSkinWeights(),p.mode===b?l.drawMode=THREE.TriangleStripDrawMode:p.mode===T&&(l.drawMode=THREE.TriangleFanDrawMode);else if(p.mode===g)l=new THREE.LineSegments(c,f);else if(p.mode===y)l=new THREE.Line(c,f);else if(p.mode===v)l=new THREE.LineLoop(c,f);else{if(p.mode!==m)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+p.mode);l=new THREE.Points(c,f)}Object.keys(l.geometry.morphAttributes).length>0&&D(l,r),l.name=r.name||"mesh_"+e,i.length>1&&(l.name+="_"+s),C(l,r),t.assignFinalMaterial(l),a.push(l)}if(1===a.length)return a[0];var h=new THREE.Group;for(s=0,u=a.length;s<u;s++)h.add(a[s]);return h}))}))},F.prototype.loadCamera=function(e){var t,r=this.json.cameras[e],n=r[r.type];if(n)return"perspective"===r.type?t=new THREE.PerspectiveCamera(THREE.Math.radToDeg(n.yfov),n.aspectRatio||1,n.znear||1,n.zfar||2e6):"orthographic"===r.type&&(t=new THREE.OrthographicCamera(n.xmag/-2,n.xmag/2,n.ymag/2,n.ymag/-2,n.znear,n.zfar)),void 0!==r.name&&(t.name=r.name),C(t,r),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")},F.prototype.loadSkin=function(e){var t=this.json.skins[e],r={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(r):this.getDependency("accessor",t.inverseBindMatrices).then((function(e){return r.inverseBindMatrices=e,r}))},F.prototype.loadAnimation=function(e){for(var t=this.json.animations[e],r=[],n=[],o=[],i=[],a=[],s=0,u=t.channels.length;s<u;s++){var l=t.channels[s],c=t.samplers[l.sampler],p=l.target,f=void 0!==p.node?p.node:p.id,d=void 0!==t.parameters?t.parameters[c.input]:c.input,m=void 0!==t.parameters?t.parameters[c.output]:c.output;r.push(this.getDependency("node",f)),n.push(this.getDependency("accessor",d)),o.push(this.getDependency("accessor",m)),i.push(c),a.push(p)}return Promise.all([Promise.all(r),Promise.all(n),Promise.all(o),Promise.all(i),Promise.all(a)]).then((function(r){for(var n=r[0],o=r[1],i=r[2],a=r[3],s=r[4],u=[],l=0,c=n.length;l<c;l++){var p=n[l],f=o[l],d=i[l],m=a[l],g=s[l];if(void 0!==p){var v;switch(p.updateMatrix(),p.matrixAutoUpdate=!0,M[g.path]){case M.weights:v=THREE.NumberKeyframeTrack;break;case M.rotation:v=THREE.QuaternionKeyframeTrack;break;case M.position:case M.scale:default:v=THREE.VectorKeyframeTrack}var y=p.name?p.name:p.uuid,E=void 0!==m.interpolation?A[m.interpolation]:THREE.InterpolateLinear,b=[];M[g.path]===M.weights?p.traverse((function(e){!0===e.isMesh&&e.morphTargetInfluences&&b.push(e.name?e.name:e.uuid)})):b.push(y);var T=d.array;if(d.normalized){var w;if(T.constructor===Int8Array)w=1/127;else if(T.constructor===Uint8Array)w=1/255;else if(T.constructor==Int16Array)w=1/32767;else{if(T.constructor!==Uint16Array)throw new Error("THREE.GLTFLoader: Unsupported output accessor component type.");w=1/65535}for(var R=new Float32Array(T.length),x=0,_=T.length;x<_;x++)R[x]=T[x]*w;T=R}for(x=0,_=b.length;x<_;x++){var S=new v(b[x]+"."+M[g.path],f.array,T,E);"CUBICSPLINE"===m.interpolation&&(S.createInterpolant=function(e){return new h(this.times,this.values,this.getValueSize()/3,e)},S.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),u.push(S)}}}var H=void 0!==t.name?t.name:"animation_"+e;return new THREE.AnimationClip(H,void 0,u)}))},F.prototype.loadNode=function(e){var t,n=this.json,o=this.extensions,i=this,a=n.meshReferences,s=n.meshUses,u=n.nodes[e];return(t=[],void 0!==u.mesh&&t.push(i.getDependency("mesh",u.mesh).then((function(e){var t;if(a[u.mesh]>1){var r=s[u.mesh]++;(t=e.clone()).name+="_instance_"+r,t.onBeforeRender=e.onBeforeRender;for(var n=0,o=t.children.length;n<o;n++)t.children[n].name+="_instance_"+r,t.children[n].onBeforeRender=e.children[n].onBeforeRender}else t=e;return void 0!==u.weights&&t.traverse((function(e){if(e.isMesh)for(var t=0,r=u.weights.length;t<r;t++)e.morphTargetInfluences[t]=u.weights[t]})),t}))),void 0!==u.camera&&t.push(i.getDependency("camera",u.camera)),u.extensions&&u.extensions[r.KHR_LIGHTS_PUNCTUAL]&&void 0!==u.extensions[r.KHR_LIGHTS_PUNCTUAL].light&&t.push(i.getDependency("light",u.extensions[r.KHR_LIGHTS_PUNCTUAL].light)),Promise.all(t)).then((function(e){var t;if((t=!0===u.isBone?new THREE.Bone:e.length>1?new THREE.Group:1===e.length?e[0]:new THREE.Object3D)!==e[0])for(var r=0,n=e.length;r<n;r++)t.add(e[r]);if(void 0!==u.name&&(t.userData.name=u.name,t.name=THREE.PropertyBinding.sanitizeNodeName(u.name)),C(t,u),u.extensions&&I(o,t,u),void 0!==u.matrix){var i=new THREE.Matrix4;i.fromArray(u.matrix),t.applyMatrix(i)}else void 0!==u.translation&&t.position.fromArray(u.translation),void 0!==u.rotation&&t.quaternion.fromArray(u.rotation),void 0!==u.scale&&t.scale.fromArray(u.scale);return t}))},F.prototype.loadScene=function(){function e(t,r,n,o){var i=n.nodes[t];return o.getDependency("node",t).then((function(e){return void 0===i.skin?e:o.getDependency("skin",i.skin).then((function(e){for(var r=[],n=0,i=(t=e).joints.length;n<i;n++)r.push(o.getDependency("node",t.joints[n]));return Promise.all(r)})).then((function(r){return e.traverse((function(e){if(e.isMesh){for(var n=[],o=[],i=0,a=r.length;i<a;i++){var s=r[i];if(s){n.push(s);var u=new THREE.Matrix4;void 0!==t.inverseBindMatrices&&u.fromArray(t.inverseBindMatrices.array,16*i),o.push(u)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[i])}e.bind(new THREE.Skeleton(n,o),e.matrixWorld)}})),e}));var t})).then((function(t){r.add(t);var a=[];if(i.children)for(var s=i.children,u=0,l=s.length;u<l;u++){var c=s[u];a.push(e(c,t,n,o))}return Promise.all(a)}))}return function(t){var r=this.json,n=this.extensions,o=this.json.scenes[t],i=new THREE.Scene;void 0!==o.name&&(i.name=o.name),C(i,o),o.extensions&&I(n,i,o);for(var a=o.nodes||[],s=[],u=0,l=a.length;u<l;u++)s.push(e(a[u],i,r,this));return Promise.all(s).then((function(){return i}))}}(),e}()},function(e,t){THREE.OBJLoader=function(){var e=/^[og]\s*(.+)?/,t=/^mtllib /,r=/^usemtl /;function n(){var e={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materialLibraries:[],startObject:function(e,t){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=e,void(this.object.fromDeclaration=!1!==t);var r=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:!1!==t,geometry:{vertices:[],normals:[],colors:[],uvs:[]},materials:[],smooth:!0,startMaterial:function(e,t){var r=this._finalize(!1);r&&(r.inherited||r.groupCount<=0)&&this.materials.splice(r.index,1);var n={index:this.materials.length,name:e||"",mtllib:Array.isArray(t)&&t.length>0?t[t.length-1]:"",smooth:void 0!==r?r.smooth:this.smooth,groupStart:void 0!==r?r.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(e){var t={index:"number"==typeof e?e:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return t.clone=this.clone.bind(t),t}};return this.materials.push(n),n},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(e){var t=this.currentMaterial();if(t&&-1===t.groupEnd&&(t.groupEnd=this.geometry.vertices.length/3,t.groupCount=t.groupEnd-t.groupStart,t.inherited=!1),e&&this.materials.length>1)for(var r=this.materials.length-1;r>=0;r--)this.materials[r].groupCount<=0&&this.materials.splice(r,1);return e&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),t}},r&&r.name&&"function"==typeof r.clone){var n=r.clone(0);n.inherited=!0,this.object.materials.push(n)}this.objects.push(this.object)},finalize:function(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(e,t){var r=parseInt(e,10);return 3*(r>=0?r-1:r+t/3)},parseNormalIndex:function(e,t){var r=parseInt(e,10);return 3*(r>=0?r-1:r+t/3)},parseUVIndex:function(e,t){var r=parseInt(e,10);return 2*(r>=0?r-1:r+t/2)},addVertex:function(e,t,r){var n=this.vertices,o=this.object.geometry.vertices;o.push(n[e+0],n[e+1],n[e+2]),o.push(n[t+0],n[t+1],n[t+2]),o.push(n[r+0],n[r+1],n[r+2])},addVertexPoint:function(e){var t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addVertexLine:function(e){var t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addNormal:function(e,t,r){var n=this.normals,o=this.object.geometry.normals;o.push(n[e+0],n[e+1],n[e+2]),o.push(n[t+0],n[t+1],n[t+2]),o.push(n[r+0],n[r+1],n[r+2])},addColor:function(e,t,r){var n=this.colors,o=this.object.geometry.colors;o.push(n[e+0],n[e+1],n[e+2]),o.push(n[t+0],n[t+1],n[t+2]),o.push(n[r+0],n[r+1],n[r+2])},addUV:function(e,t,r){var n=this.uvs,o=this.object.geometry.uvs;o.push(n[e+0],n[e+1]),o.push(n[t+0],n[t+1]),o.push(n[r+0],n[r+1])},addUVLine:function(e){var t=this.uvs;this.object.geometry.uvs.push(t[e+0],t[e+1])},addFace:function(e,t,r,n,o,i,a,s,u){var l=this.vertices.length,c=this.parseVertexIndex(e,l),p=this.parseVertexIndex(t,l),f=this.parseVertexIndex(r,l);if(this.addVertex(c,p,f),void 0!==n&&""!==n){var h=this.uvs.length;c=this.parseUVIndex(n,h),p=this.parseUVIndex(o,h),f=this.parseUVIndex(i,h),this.addUV(c,p,f)}if(void 0!==a&&""!==a){var d=this.normals.length;c=this.parseNormalIndex(a,d),p=a===s?c:this.parseNormalIndex(s,d),f=a===u?c:this.parseNormalIndex(u,d),this.addNormal(c,p,f)}this.colors.length>0&&this.addColor(c,p,f)},addPointGeometry:function(e){this.object.geometry.type="Points";for(var t=this.vertices.length,r=0,n=e.length;r<n;r++)this.addVertexPoint(this.parseVertexIndex(e[r],t))},addLineGeometry:function(e,t){this.object.geometry.type="Line";for(var r=this.vertices.length,n=this.uvs.length,o=0,i=e.length;o<i;o++)this.addVertexLine(this.parseVertexIndex(e[o],r));var a=0;for(i=t.length;a<i;a++)this.addUVLine(this.parseUVIndex(t[a],n))}};return e.startObject("",!1),e}function o(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager,this.materials=null}return o.prototype={constructor:o,load:function(e,t,r,n){var o=this,i=new THREE.FileLoader(o.manager);i.setPath(this.path),i.load(e,(function(e){t(o.parse(e))}),r,n)},setPath:function(e){return this.path=e,this},setMaterials:function(e){return this.materials=e,this},parse:function(o){console.time("OBJLoader");var i=new n;-1!==o.indexOf("\r\n")&&(o=o.replace(/\r\n/g,"\n")),-1!==o.indexOf("\\\n")&&(o=o.replace(/\\\n/g,""));for(var a=o.split("\n"),s="",u="",l=[],c="function"==typeof"".trimLeft,p=0,f=a.length;p<f;p++)if(s=a[p],0!==(s=c?s.trimLeft():s.trim()).length&&"#"!==(u=s.charAt(0)))if("v"===u){var h=s.split(/\s+/);switch(h[0]){case"v":i.vertices.push(parseFloat(h[1]),parseFloat(h[2]),parseFloat(h[3])),h.length>=7&&i.colors.push(parseFloat(h[4]),parseFloat(h[5]),parseFloat(h[6]));break;case"vn":i.normals.push(parseFloat(h[1]),parseFloat(h[2]),parseFloat(h[3]));break;case"vt":i.uvs.push(parseFloat(h[1]),parseFloat(h[2]))}}else if("f"===u){for(var d=s.substr(1).trim().split(/\s+/),m=[],g=0,v=d.length;g<v;g++){var y=d[g];if(y.length>0){var E=y.split("/");m.push(E)}}var b=m[0];for(g=1,v=m.length-1;g<v;g++){var T=m[g],w=m[g+1];i.addFace(b[0],T[0],w[0],b[1],T[1],w[1],b[2],T[2],w[2])}}else if("l"===u){var R=s.substring(1).trim().split(" "),x=[],_=[];if(-1===s.indexOf("/"))x=R;else for(var S=0,M=R.length;S<M;S++){var A=R[S].split("/");""!==A[0]&&x.push(A[0]),""!==A[1]&&_.push(A[1])}i.addLineGeometry(x,_)}else if("p"===u){var H=s.substr(1).trim().split(" ");i.addPointGeometry(H)}else if(null!==(l=e.exec(s))){var L=(" "+l[0].substr(1).trim()).substr(1);i.startObject(L)}else if(r.test(s))i.object.startMaterial(s.substring(7).trim(),i.materialLibraries);else if(t.test(s))i.materialLibraries.push(s.substring(7).trim());else{if("s"!==u){if("\0"===s)continue;throw new Error('THREE.OBJLoader: Unexpected line: "'+s+'"')}if((l=s.split(" ")).length>1){var P=l[1].trim().toLowerCase();i.object.smooth="0"!==P&&"off"!==P}else i.object.smooth=!0;(Y=i.object.currentMaterial())&&(Y.smooth=i.object.smooth)}i.finalize();var B=new THREE.Group;B.materialLibraries=[].concat(i.materialLibraries);for(p=0,f=i.objects.length;p<f;p++){var O=i.objects[p],I=O.geometry,C=O.materials,D="Line"===I.type,j="Points"===I.type,U=!1;if(0!==I.vertices.length){var F=new THREE.BufferGeometry;F.addAttribute("position",new THREE.Float32BufferAttribute(I.vertices,3)),I.normals.length>0?F.addAttribute("normal",new THREE.Float32BufferAttribute(I.normals,3)):F.computeVertexNormals(),I.colors.length>0&&(U=!0,F.addAttribute("color",new THREE.Float32BufferAttribute(I.colors,3))),I.uvs.length>0&&F.addAttribute("uv",new THREE.Float32BufferAttribute(I.uvs,2));for(var k,N=[],G=0,$=C.length;G<$;G++){var V=C[G],Y=void 0;if(null!==this.materials)if(Y=this.materials.create(V.name),!D||!Y||Y instanceof THREE.LineBasicMaterial){if(j&&Y&&!(Y instanceof THREE.PointsMaterial)){var z=new THREE.PointsMaterial({size:10,sizeAttenuation:!1});THREE.Material.prototype.copy.call(z,Y),z.color.copy(Y.color),z.map=Y.map,z.lights=!1,Y=z}}else{var X=new THREE.LineBasicMaterial;THREE.Material.prototype.copy.call(X,Y),X.color.copy(Y.color),X.lights=!1,Y=X}Y||((Y=D?new THREE.LineBasicMaterial:j?new THREE.PointsMaterial({size:1,sizeAttenuation:!1}):new THREE.MeshPhongMaterial).name=V.name),Y.flatShading=!V.smooth,Y.vertexColors=U?THREE.VertexColors:THREE.NoColors,N.push(Y)}if(N.length>1){for(G=0,$=C.length;G<$;G++){V=C[G];F.addGroup(V.groupStart,V.groupCount,G)}k=D?new THREE.LineSegments(F,N):j?new THREE.Points(F,N):new THREE.Mesh(F,N)}else k=D?new THREE.LineSegments(F,N[0]):j?new THREE.Points(F,N[0]):new THREE.Mesh(F,N[0]);k.name=O.name,B.add(k)}}return console.timeEnd("OBJLoader"),B}},o}()},function(e,t){THREE.BasisTextureLoader=function(e){THREE.Loader.call(this,e),this.transcoderPath="",this.transcoderBinary=null,this.transcoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.workerConfig={format:null,etcSupported:!1,dxtSupported:!1,pvrtcSupported:!1}},THREE.BasisTextureLoader.prototype=Object.assign(Object.create(THREE.Loader.prototype),{constructor:THREE.BasisTextureLoader,setTranscoderPath:function(e){return this.transcoderPath=e,this},setWorkerLimit:function(e){return this.workerLimit=e,this},detectSupport:function(e){var t=this.workerConfig;if(t.etcSupported=!!e.extensions.get("WEBGL_compressed_texture_etc1"),t.dxtSupported=!!e.extensions.get("WEBGL_compressed_texture_s3tc"),t.pvrtcSupported=!!e.extensions.get("WEBGL_compressed_texture_pvrtc")||!!e.extensions.get("WEBKIT_WEBGL_compressed_texture_pvrtc"),t.etcSupported)t.format=THREE.BasisTextureLoader.BASIS_FORMAT.cTFETC1;else if(t.dxtSupported)t.format=THREE.BasisTextureLoader.BASIS_FORMAT.cTFBC1;else{if(!t.pvrtcSupported)throw new Error("THREE.BasisTextureLoader: No suitable compressed texture format found.");t.format=THREE.BasisTextureLoader.BASIS_FORMAT.cTFPVRTC1_4_OPAQUE_ONLY}return this},load:function(e,t,r,n){var o=new THREE.FileLoader(this.manager);o.setResponseType("arraybuffer"),o.load(e,e=>{this._createTexture(e).then(t).catch(n)},r,n)},_createTexture:function(e){var t,r,n=this._getWorker().then(n=>(t=n,r=this.workerNextTaskID++,new Promise((n,o)=>{t._callbacks[r]={resolve:n,reject:o},t._taskCosts[r]=e.byteLength,t._taskLoad+=t._taskCosts[r],t.postMessage({type:"transcode",id:r,buffer:e},[e])}))).then(e=>{var t,r=this.workerConfig,{width:n,height:o,mipmaps:i}=e;if(r.etcSupported)t=new THREE.CompressedTexture(i,n,o,THREE.RGB_ETC1_Format);else if(r.dxtSupported)t=new THREE.CompressedTexture(i,n,o,THREE.BasisTextureLoader.DXT_FORMAT_MAP[r.format],THREE.UnsignedByteType);else{if(!r.pvrtcSupported)throw new Error("THREE.BasisTextureLoader: No supported format available.");t=new THREE.CompressedTexture(i,n,o,THREE.RGB_PVRTC_4BPPV1_Format)}return t.minFilter=1===i.length?THREE.LinearFilter:THREE.LinearMipmapLinearFilter,t.magFilter=THREE.LinearFilter,t.generateMipmaps=!1,t.needsUpdate=!0,t});return n.finally(()=>{t&&r&&(t._taskLoad-=t._taskCosts[r],delete t._callbacks[r],delete t._taskCosts[r])}),n},_initTranscoder:function(){if(!this.transcoderBinary){var e=new THREE.FileLoader(this.manager);e.setPath(this.transcoderPath);var t=new Promise((t,r)=>{e.load("basis_transcoder.js",t,void 0,r)}),r=new THREE.FileLoader(this.manager);r.setPath(this.transcoderPath),r.setResponseType("arraybuffer");var n=new Promise((e,t)=>{r.load("basis_transcoder.wasm",e,void 0,t)});this.transcoderPending=Promise.all([t,n]).then(([e,t])=>{var r=THREE.BasisTextureLoader.BasisWorker.toString(),n=["/* basis_transcoder.js */","var Module;","function createBasisModule () {","  "+e,"  return Module;","}","","/* worker */",r.substring(r.indexOf("{")+1,r.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([n])),this.transcoderBinary=t})}return this.transcoderPending},_getWorker:function(){return this._initTranscoder().then(()=>{if(this.workerPool.length<this.workerLimit){var e=new Worker(this.workerSourceURL);e._callbacks={},e._taskCosts={},e._taskLoad=0,e.postMessage({type:"init",config:this.workerConfig,transcoderBinary:this.transcoderBinary}),e.onmessage=function(t){var r=t.data;switch(r.type){case"transcode":e._callbacks[r.id].resolve(r);break;case"error":e._callbacks[r.id].reject(r);break;default:console.error('THREE.BasisTextureLoader: Unexpected message, "'+r.type+'"')}},this.workerPool.push(e)}else this.workerPool.sort((function(e,t){return e._taskLoad>t._taskLoad?-1:1}));return this.workerPool[this.workerPool.length-1]})},dispose:function(){for(var e=0;e<this.workerPool.length;e++)this.workerPool[e].terminate();return this.workerPool.length=0,this}}),THREE.BasisTextureLoader.BASIS_FORMAT={cTFETC1:0,cTFBC1:1,cTFBC4:2,cTFPVRTC1_4_OPAQUE_ONLY:3,cTFBC7_M6_OPAQUE_ONLY:4,cTFETC2:5,cTFBC3:6,cTFBC5:7},THREE.BasisTextureLoader.DXT_FORMAT={COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779},THREE.BasisTextureLoader.DXT_FORMAT_MAP={},THREE.BasisTextureLoader.DXT_FORMAT_MAP[THREE.BasisTextureLoader.BASIS_FORMAT.cTFBC1]=THREE.BasisTextureLoader.DXT_FORMAT.COMPRESSED_RGB_S3TC_DXT1_EXT,THREE.BasisTextureLoader.DXT_FORMAT_MAP[THREE.BasisTextureLoader.BASIS_FORMAT.cTFBC3]=THREE.BasisTextureLoader.DXT_FORMAT.COMPRESSED_RGBA_S3TC_DXT5_EXT,THREE.BasisTextureLoader.BasisWorker=function(){var e,t,r;onmessage=function(n){var o,i=n.data;switch(i.type){case"init":e=i.config,o=i.transcoderBinary,t=new Promise(e=>{Module={wasmBinary:o,onRuntimeInitialized:e}}).then(()=>{var{BasisFile:e,initializeBasis:t}=Module;r=e,t()}),createBasisModule();break;case"transcode":t.then(()=>{try{for(var{width:t,height:n,mipmaps:o}=function(t){var n=new r(new Uint8Array(t)),o=n.getImageWidth(0,0),i=n.getImageHeight(0,0),a=n.getNumLevels(0);function s(){n.close(),n.delete()}if(!o||!i||!a)throw s(),new Error("THREE.BasisTextureLoader:  Invalid .basis file");if(!n.startTranscoding())throw s(),new Error("THREE.BasisTextureLoader: .startTranscoding failed");n.getHasAlpha()&&console.warn("THREE.BasisTextureLoader: Alpha not yet implemented.");for(var u=[],l=0;l<a;l++){var c=n.getImageWidth(0,l),p=n.getImageHeight(0,l),f=new Uint8Array(n.getImageTranscodedSizeInBytes(0,l,e.format));if(!n.transcodeImage(f,0,l,e.format,e.etcSupported?0:e.dxtSupported?1:0,0))throw s(),new Error("THREE.BasisTextureLoader: .transcodeImage failed.");u.push({data:f,width:c,height:p})}return s(),{width:o,height:i,mipmaps:u}}(i.buffer),a=[],s=0;s<o.length;++s)a.push(o[s].data.buffer);self.postMessage({type:"transcode",id:i.id,width:t,height:n,mipmaps:o},a)}catch(e){console.error(e),self.postMessage({type:"error",id:i.id,error:e.message})}})}}}},function(e,t,r){(function(t){var n=r(22),o=function(){},i=r(45),a=r(46),s=r(49),u=r(50),l=r(6),c=self.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest;e.exports=function(e,r){r="function"==typeof r?r:o,"string"==typeof e?e={uri:e}:e||(e={}),e.binary&&(e=function(e){if(c)return l(e,{responseType:"arraybuffer"});if(void 0===self.XMLHttpRequest)throw new Error("your browser does not support XHR loading");var t=new self.XMLHttpRequest;return t.overrideMimeType("text/plain; charset=x-user-defined"),l({xhr:t},e)}(e)),n(e,(function(n,l,c){if(n)return r(n);if(!/^2/.test(l.statusCode))return r(new Error("http status code: "+l.statusCode));if(!c)return r(new Error("no body result"));var p,f,h=!1;if(p=c,"[object ArrayBuffer]"===Object.prototype.toString.call(p)){var d=new Uint8Array(c);c=new t(d,"binary")}u(c)&&(h=!0,"string"==typeof c&&(c=new t(c,"binary"))),h||(t.isBuffer(c)&&(c=c.toString(e.encoding)),c=c.trim());try{var m=l.headers["content-type"];f=h?s(c):/json/.test(m)||"{"===c.charAt(0)?JSON.parse(c):/xml/.test(m)||"<"===c.charAt(0)?a(c):i(c)}catch(e){r(new Error("error parsing font "+e.message)),r=o}r(null,f)}))}}).call(this,r(2).Buffer)},function(e,t,r){"use strict";t.byteLength=function(e){var t=l(e),r=t[0],n=t[1];return 3*(r+n)/4-n},t.toByteArray=function(e){var t,r,n=l(e),a=n[0],s=n[1],u=new i(function(e,t,r){return 3*(t+r)/4-r}(0,a,s)),c=0,p=s>0?a-4:a;for(r=0;r<p;r+=4)t=o[e.charCodeAt(r)]<<18|o[e.charCodeAt(r+1)]<<12|o[e.charCodeAt(r+2)]<<6|o[e.charCodeAt(r+3)],u[c++]=t>>16&255,u[c++]=t>>8&255,u[c++]=255&t;2===s&&(t=o[e.charCodeAt(r)]<<2|o[e.charCodeAt(r+1)]>>4,u[c++]=255&t);1===s&&(t=o[e.charCodeAt(r)]<<10|o[e.charCodeAt(r+1)]<<4|o[e.charCodeAt(r+2)]>>2,u[c++]=t>>8&255,u[c++]=255&t);return u},t.fromByteArray=function(e){for(var t,r=e.length,o=r%3,i=[],a=0,s=r-o;a<s;a+=16383)i.push(c(e,a,a+16383>s?s:a+16383));1===o?(t=e[r-1],i.push(n[t>>2]+n[t<<4&63]+"==")):2===o&&(t=(e[r-2]<<8)+e[r-1],i.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"="));return i.join("")};for(var n=[],o=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,u=a.length;s<u;++s)n[s]=a[s],o[a.charCodeAt(s)]=s;function l(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function c(e,t,r){for(var o,i,a=[],s=t;s<r;s+=3)o=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),a.push(n[(i=o)>>18&63]+n[i>>12&63]+n[i>>6&63]+n[63&i]);return a.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,r,n,o){var i,a,s=8*o-n-1,u=(1<<s)-1,l=u>>1,c=-7,p=r?o-1:0,f=r?-1:1,h=e[t+p];for(p+=f,i=h&(1<<-c)-1,h>>=-c,c+=s;c>0;i=256*i+e[t+p],p+=f,c-=8);for(a=i&(1<<-c)-1,i>>=-c,c+=n;c>0;a=256*a+e[t+p],p+=f,c-=8);if(0===i)i=1-l;else{if(i===u)return a?NaN:1/0*(h?-1:1);a+=Math.pow(2,n),i-=l}return(h?-1:1)*a*Math.pow(2,i-n)},t.write=function(e,t,r,n,o,i){var a,s,u,l=8*i-o-1,c=(1<<l)-1,p=c>>1,f=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,h=n?0:i-1,d=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=c):(a=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-a))<1&&(a--,u*=2),(t+=a+p>=1?f/u:f*Math.pow(2,1-p))*u>=2&&(a++,u/=2),a+p>=c?(s=0,a=c):a+p>=1?(s=(t*u-1)*Math.pow(2,o),a+=p):(s=t*Math.pow(2,p-1)*Math.pow(2,o),a=0));o>=8;e[r+h]=255&s,h+=d,s/=256,o-=8);for(a=a<<o|s,l+=o;l>0;e[r+h]=255&a,h+=d,a/=256,l-=8);e[r+h-d]|=128*m}},function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},function(e,t,r){"use strict";var n=r(23),o=r(24),i=r(25),a=r(6);function s(e,t,r){var n=e;return o(t)?(r=t,"string"==typeof e&&(n={uri:e})):n=a(t,{uri:e}),n.callback=r,n}function u(e,t,r){return l(t=s(e,t,r))}function l(e){if(void 0===e.callback)throw new Error("callback argument missing");var t=!1,r=function(r,n,o){t||(t=!0,e.callback(r,n,o))};function n(){var e=void 0;if(e=c.response?c.response:c.responseText||function(e){try{if("document"===e.responseType)return e.responseXML;var t=e.responseXML&&"parsererror"===e.responseXML.documentElement.nodeName;if(""===e.responseType&&!t)return e.responseXML}catch(e){}return null}(c),v)try{e=JSON.parse(e)}catch(e){}return e}function o(e){return clearTimeout(p),e instanceof Error||(e=new Error(""+(e||"Unknown XMLHttpRequest Error"))),e.statusCode=0,r(e,y)}function a(){if(!l){var t;clearTimeout(p),t=e.useXDR&&void 0===c.status?200:1223===c.status?204:c.status;var o=y,a=null;return 0!==t?(o={body:n(),statusCode:t,method:h,headers:{},url:f,rawRequest:c},c.getAllResponseHeaders&&(o.headers=i(c.getAllResponseHeaders()))):a=new Error("Internal XMLHttpRequest Error"),r(a,o,o.body)}}var s,l,c=e.xhr||null;c||(c=e.cors||e.useXDR?new u.XDomainRequest:new u.XMLHttpRequest);var p,f=c.url=e.uri||e.url,h=c.method=e.method||"GET",d=e.body||e.data,m=c.headers=e.headers||{},g=!!e.sync,v=!1,y={body:void 0,headers:{},statusCode:0,method:h,url:f,rawRequest:c};if("json"in e&&!1!==e.json&&(v=!0,m.accept||m.Accept||(m.Accept="application/json"),"GET"!==h&&"HEAD"!==h&&(m["content-type"]||m["Content-Type"]||(m["Content-Type"]="application/json"),d=JSON.stringify(!0===e.json?d:e.json))),c.onreadystatechange=function(){4===c.readyState&&setTimeout(a,0)},c.onload=a,c.onerror=o,c.onprogress=function(){},c.onabort=function(){l=!0},c.ontimeout=o,c.open(h,f,!g,e.username,e.password),g||(c.withCredentials=!!e.withCredentials),!g&&e.timeout>0&&(p=setTimeout((function(){if(!l){l=!0,c.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",o(e)}}),e.timeout)),c.setRequestHeader)for(s in m)m.hasOwnProperty(s)&&c.setRequestHeader(s,m[s]);else if(e.headers&&!function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}(e.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in e&&(c.responseType=e.responseType),"beforeSend"in e&&"function"==typeof e.beforeSend&&e.beforeSend(c),c.send(d||null),c}e.exports=u,e.exports.default=u,u.XMLHttpRequest=n.XMLHttpRequest||function(){},u.XDomainRequest="withCredentials"in new u.XMLHttpRequest?u.XMLHttpRequest:n.XDomainRequest,function(e,t){for(var r=0;r<e.length;r++)t(e[r])}(["get","put","post","patch","head","delete"],(function(e){u["delete"===e?"del":e]=function(t,r,n){return(r=s(t,r,n)).method=e.toUpperCase(),l(r)}}))},function(e,t,r){(function(t){var r;r="undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},e.exports=r}).call(this,r(3))},function(e,t){e.exports=function(e){var t=r.call(e);return"[object Function]"===t||"function"==typeof e&&"[object RegExp]"!==t||"undefined"!=typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)};var r=Object.prototype.toString},function(e,t,r){var n=r(26),o=r(44);e.exports=function(e){if(!e)return{};var t={};return o(n(e).split("\n"),(function(e){var r,o=e.indexOf(":"),i=n(e.slice(0,o)).toLowerCase(),a=n(e.slice(o+1));void 0===t[i]?t[i]=a:(r=t[i],"[object Array]"===Object.prototype.toString.call(r)?t[i].push(a):t[i]=[t[i],a])})),t}},function(e,t,r){"use strict";var n=r(0),o=r(7),i=r(9),a=r(11),s=r(43),u=n.call(Function.call,a());o(u,{getPolyfill:a,implementation:i,shim:s}),e.exports=u},function(e,t,r){"use strict";var n="Function.prototype.bind called on incompatible ",o=Array.prototype.slice,i=Object.prototype.toString;e.exports=function(e){var t=this;if("function"!=typeof t||"[object Function]"!==i.call(t))throw new TypeError(n+t);for(var r,a=o.call(arguments,1),s=function(){if(this instanceof r){var n=t.apply(this,a.concat(o.call(arguments)));return Object(n)===n?n:this}return t.apply(e,a.concat(o.call(arguments)))},u=Math.max(0,t.length-a.length),l=[],c=0;c<u;c++)l.push("$"+c);if(r=Function("binder","return function ("+l.join(",")+"){ return binder.apply(this,arguments); }")(s),t.prototype){var p=function(){};p.prototype=t.prototype,r.prototype=new p,p.prototype=null}return r}},function(e,t,r){"use strict";var n=Array.prototype.slice,o=r(8),i=Object.keys,a=i?function(e){return i(e)}:r(29),s=Object.keys;a.shim=function(){Object.keys?function(){var e=Object.keys(arguments);return e&&e.length===arguments.length}(1,2)||(Object.keys=function(e){return o(e)?s(n.call(e)):s(e)}):Object.keys=a;return Object.keys||a},e.exports=a},function(e,t,r){"use strict";var n;if(!Object.keys){var o=Object.prototype.hasOwnProperty,i=Object.prototype.toString,a=r(8),s=Object.prototype.propertyIsEnumerable,u=!s.call({toString:null},"toString"),l=s.call((function(){}),"prototype"),c=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],p=function(e){var t=e.constructor;return t&&t.prototype===e},f={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},h=function(){if("undefined"==typeof window)return!1;for(var e in window)try{if(!f["$"+e]&&o.call(window,e)&&null!==window[e]&&"object"==typeof window[e])try{p(window[e])}catch(e){return!0}}catch(e){return!0}return!1}();n=function(e){var t=null!==e&&"object"==typeof e,r="[object Function]"===i.call(e),n=a(e),s=t&&"[object String]"===i.call(e),f=[];if(!t&&!r&&!n)throw new TypeError("Object.keys called on a non-object");var d=l&&r;if(s&&e.length>0&&!o.call(e,0))for(var m=0;m<e.length;++m)f.push(String(m));if(n&&e.length>0)for(var g=0;g<e.length;++g)f.push(String(g));else for(var v in e)d&&"prototype"===v||!o.call(e,v)||f.push(String(v));if(u)for(var y=function(e){if("undefined"==typeof window||!h)return p(e);try{return p(e)}catch(e){return!1}}(e),E=0;E<c.length;++E)y&&"constructor"===c[E]||!o.call(e,c[E])||f.push(c[E]);return f}}e.exports=n},function(e,t,r){"use strict";var n=r(1),o=n("%Object%"),i=n("%EvalError%"),a=n("%TypeError%"),s=n("%String%"),u=n("%Date%"),l=n("%Number%"),c=n("%Math.floor%"),p=n("%Date.UTC%"),f=n("%Math.abs%"),h=r(33),d=r(34),m=r(35),g=r(36),v=r(37),y=r(38),E=r(39),b=r(10),T=r(5),w=r(41),R=r(4),x=b("Date.prototype.getUTCFullYear"),_={ToPrimitive:w,ToBoolean:function(e){return!!e},ToNumber:function(e){return+e},ToInteger:function(e){var t=this.ToNumber(e);return m(t)?0:0!==t&&g(t)?v(t)*Math.floor(Math.abs(t)):t},ToInt32:function(e){return this.ToNumber(e)>>0},ToUint32:function(e){return this.ToNumber(e)>>>0},ToUint16:function(e){var t=this.ToNumber(e);if(m(t)||0===t||!g(t))return 0;var r=v(t)*Math.floor(Math.abs(t));return y(r,65536)},ToString:function(e){return s(e)},ToObject:function(e){return this.CheckObjectCoercible(e),o(e)},CheckObjectCoercible:function(e,t){if(null==e)throw new a(t||"Cannot call method on "+e);return e},IsCallable:T,SameValue:function(e,t){return e===t?0!==e||1/e==1/t:m(e)&&m(t)},Type:function(e){return null===e?"Null":void 0===e?"Undefined":"function"==typeof e||"object"==typeof e?"Object":"number"==typeof e?"Number":"boolean"==typeof e?"Boolean":"string"==typeof e?"String":void 0},IsPropertyDescriptor:function(e){return d(this,e)},IsAccessorDescriptor:function(e){return void 0!==e&&(h(this,"Property Descriptor","Desc",e),!(!R(e,"[[Get]]")&&!R(e,"[[Set]]")))},IsDataDescriptor:function(e){return void 0!==e&&(h(this,"Property Descriptor","Desc",e),!(!R(e,"[[Value]]")&&!R(e,"[[Writable]]")))},IsGenericDescriptor:function(e){return void 0!==e&&(h(this,"Property Descriptor","Desc",e),!this.IsAccessorDescriptor(e)&&!this.IsDataDescriptor(e))},FromPropertyDescriptor:function(e){if(void 0===e)return e;if(h(this,"Property Descriptor","Desc",e),this.IsDataDescriptor(e))return{value:e["[[Value]]"],writable:!!e["[[Writable]]"],enumerable:!!e["[[Enumerable]]"],configurable:!!e["[[Configurable]]"]};if(this.IsAccessorDescriptor(e))return{get:e["[[Get]]"],set:e["[[Set]]"],enumerable:!!e["[[Enumerable]]"],configurable:!!e["[[Configurable]]"]};throw new a("FromPropertyDescriptor must be called with a fully populated Property Descriptor")},ToPropertyDescriptor:function(e){if("Object"!==this.Type(e))throw new a("ToPropertyDescriptor requires an object");var t={};if(R(e,"enumerable")&&(t["[[Enumerable]]"]=this.ToBoolean(e.enumerable)),R(e,"configurable")&&(t["[[Configurable]]"]=this.ToBoolean(e.configurable)),R(e,"value")&&(t["[[Value]]"]=e.value),R(e,"writable")&&(t["[[Writable]]"]=this.ToBoolean(e.writable)),R(e,"get")){var r=e.get;if(void 0!==r&&!this.IsCallable(r))throw new TypeError("getter must be a function");t["[[Get]]"]=r}if(R(e,"set")){var n=e.set;if(void 0!==n&&!this.IsCallable(n))throw new a("setter must be a function");t["[[Set]]"]=n}if((R(t,"[[Get]]")||R(t,"[[Set]]"))&&(R(t,"[[Value]]")||R(t,"[[Writable]]")))throw new a("Invalid property descriptor. Cannot both specify accessors and a value or writable attribute");return t},"Abstract Equality Comparison":function(e,t){var r=this.Type(e),n=this.Type(t);return r===n?e===t:null==e&&null==t||("Number"===r&&"String"===n?this["Abstract Equality Comparison"](e,this.ToNumber(t)):"String"===r&&"Number"===n?this["Abstract Equality Comparison"](this.ToNumber(e),t):"Boolean"===r?this["Abstract Equality Comparison"](this.ToNumber(e),t):"Boolean"===n?this["Abstract Equality Comparison"](e,this.ToNumber(t)):"String"!==r&&"Number"!==r||"Object"!==n?"Object"===r&&("String"===n||"Number"===n)&&this["Abstract Equality Comparison"](this.ToPrimitive(e),t):this["Abstract Equality Comparison"](e,this.ToPrimitive(t)))},"Strict Equality Comparison":function(e,t){var r=this.Type(e);return r===this.Type(t)&&("Undefined"===r||"Null"===r||e===t)},"Abstract Relational Comparison":function(e,t,r){if("Boolean"!==this.Type(r))throw new a("Assertion failed: LeftFirst argument must be a Boolean");var n,o;if(r?(n=this.ToPrimitive(e,l),o=this.ToPrimitive(t,l)):(o=this.ToPrimitive(t,l),n=this.ToPrimitive(e,l)),!("String"===this.Type(n)&&"String"===this.Type(o))){var i=this.ToNumber(n),s=this.ToNumber(o);if(m(i)||m(s))return;return(!g(i)||!g(s)||i!==s)&&((0!==i||0!==s)&&(i!==1/0&&(s===1/0||s!==-1/0&&(i===-1/0||i<s))))}return!E(o,n)&&(!!E(n,o)||n<o)},msFromTime:function(e){return y(e,1e3)},SecFromTime:function(e){return y(c(e/1e3),60)},MinFromTime:function(e){return y(c(e/6e4),60)},HourFromTime:function(e){return y(c(e/36e5),24)},Day:function(e){return c(e/864e5)},TimeWithinDay:function(e){return y(e,864e5)},DayFromYear:function(e){return 365*(e-1970)+c((e-1969)/4)-c((e-1901)/100)+c((e-1601)/400)},TimeFromYear:function(e){return 864e5*this.DayFromYear(e)},YearFromTime:function(e){return x(new u(e))},WeekDay:function(e){return y(this.Day(e)+4,7)},DaysInYear:function(e){return 0!==y(e,4)?365:0!==y(e,100)?366:0!==y(e,400)?365:366},InLeapYear:function(e){var t=this.DaysInYear(this.YearFromTime(e));if(365===t)return 0;if(366===t)return 1;throw new i("Assertion failed: there are not 365 or 366 days in a year, got: "+t)},DayWithinYear:function(e){return this.Day(e)-this.DayFromYear(this.YearFromTime(e))},MonthFromTime:function(e){var t=this.DayWithinYear(e);if(0<=t&&t<31)return 0;var r=this.InLeapYear(e);return 31<=t&&t<59+r?1:59+r<=t&&t<90+r?2:90+r<=t&&t<120+r?3:120+r<=t&&t<151+r?4:151+r<=t&&t<181+r?5:181+r<=t&&t<212+r?6:212+r<=t&&t<243+r?7:243+r<=t&&t<273+r?8:273+r<=t&&t<304+r?9:304+r<=t&&t<334+r?10:334+r<=t&&t<365+r?11:void 0},DateFromTime:function(e){var t=this.MonthFromTime(e),r=this.DayWithinYear(e);if(0===t)return r+1;if(1===t)return r-30;var n=this.InLeapYear(e);if(2===t)return r-58-n;if(3===t)return r-89-n;if(4===t)return r-119-n;if(5===t)return r-150-n;if(6===t)return r-180-n;if(7===t)return r-211-n;if(8===t)return r-242-n;if(9===t)return r-272-n;if(10===t)return r-303-n;if(11===t)return r-333-n;throw new i("Assertion failed: MonthFromTime returned an impossible value: "+t)},MakeDay:function(e,t,r){if(!g(e)||!g(t)||!g(r))return NaN;var n=this.ToInteger(e),o=this.ToInteger(t),i=this.ToInteger(r),a=n+c(o/12),s=y(o,12),u=p(a,s,1);return this.YearFromTime(u)!==a||this.MonthFromTime(u)!==s||1!==this.DateFromTime(u)?NaN:this.Day(u)+i-1},MakeDate:function(e,t){return g(e)&&g(t)?864e5*e+t:NaN},MakeTime:function(e,t,r,n){return g(e)&&g(t)&&g(r)&&g(n)?36e5*this.ToInteger(e)+6e4*this.ToInteger(t)+1e3*this.ToInteger(r)+this.ToInteger(n):NaN},TimeClip:function(e){return!g(e)||f(e)>864e13?NaN:l(new u(this.ToNumber(e)))},modulo:function(e,t){return y(e,t)}};e.exports=_},function(e,t,r){"use strict";(function(t){var n=t.Symbol,o=r(32);e.exports=function(){return"function"==typeof n&&("function"==typeof Symbol&&("symbol"==typeof n("foo")&&("symbol"==typeof Symbol("bar")&&o())))}}).call(this,r(3))},function(e,t,r){"use strict";e.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),r=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(r))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var n=Object.getOwnPropertySymbols(e);if(1!==n.length||n[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var o=Object.getOwnPropertyDescriptor(e,t);if(42!==o.value||!0!==o.enumerable)return!1}return!0}},function(e,t,r){"use strict";var n=r(1),o=n("%TypeError%"),i=n("%SyntaxError%"),a=r(4),s={"Property Descriptor":function(e,t){if("Object"!==e.Type(t))return!1;var r={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};for(var n in t)if(a(t,n)&&!r[n])return!1;var i=a(t,"[[Value]]"),s=a(t,"[[Get]]")||a(t,"[[Set]]");if(i&&s)throw new o("Property Descriptors may not be both accessor and data descriptors");return!0}};e.exports=function(e,t,r,n){var a=s[t];if("function"!=typeof a)throw new i("unknown record type: "+t);if(!a(e,n))throw new o(r+" must be a "+t)}},function(e,t,r){"use strict";var n=r(1),o=r(4),i=n("%TypeError%");e.exports=function(e,t){if("Object"!==e.Type(t))return!1;var r={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};for(var n in t)if(o(t,n)&&!r[n])return!1;if(e.IsDataDescriptor(t)&&e.IsAccessorDescriptor(t))throw new i("Property Descriptors may not be both accessor and data descriptors");return!0}},function(e,t,r){"use strict";e.exports=Number.isNaN||function(e){return e!=e}},function(e,t,r){"use strict";var n=Number.isNaN||function(e){return e!=e};e.exports=Number.isFinite||function(e){return"number"==typeof e&&!n(e)&&e!==1/0&&e!==-1/0}},function(e,t,r){"use strict";e.exports=function(e){return e>=0?1:-1}},function(e,t,r){"use strict";e.exports=function(e,t){var r=e%t;return Math.floor(r>=0?r:r+t)}},function(e,t,r){"use strict";var n=r(10)("String.prototype.slice");e.exports=function(e,t){return e===t||!(e.length>t.length)&&n(t,0,e.length)===e}},function(e,t,r){"use strict";var n=r(0),o=r(1)("%Function%"),i=o.apply,a=o.call;e.exports=function(){return n.apply(a,arguments)},e.exports.apply=function(){return n.apply(i,arguments)}},function(e,t,r){"use strict";var n=Object.prototype.toString,o=r(42),i=r(5),a=function(e){var t;if((t=arguments.length>1?arguments[1]:"[object Date]"===n.call(e)?String:Number)===String||t===Number){var r,a,s=t===String?["toString","valueOf"]:["valueOf","toString"];for(a=0;a<s.length;++a)if(i(e[s[a]])&&(r=e[s[a]](),o(r)))return r;throw new TypeError("No default value")}throw new TypeError("invalid [[DefaultValue]] hint supplied")};e.exports=function(e){return o(e)?e:arguments.length>1?a(e,arguments[1]):a(e)}},function(e,t){e.exports=function(e){return null===e||"function"!=typeof e&&"object"!=typeof e}},function(e,t,r){"use strict";var n=r(7),o=r(11);e.exports=function(){var e=o();return n(String.prototype,{trim:e},{trim:function(){return String.prototype.trim!==e}}),e}},function(e,t,r){"use strict";var n=r(5),o=Object.prototype.toString,i=Object.prototype.hasOwnProperty,a=function(e,t,r){for(var n=0,o=e.length;n<o;n++)i.call(e,n)&&(null==r?t(e[n],n,e):t.call(r,e[n],n,e))},s=function(e,t,r){for(var n=0,o=e.length;n<o;n++)null==r?t(e.charAt(n),n,e):t.call(r,e.charAt(n),n,e)},u=function(e,t,r){for(var n in e)i.call(e,n)&&(null==r?t(e[n],n,e):t.call(r,e[n],n,e))};e.exports=function(e,t,r){if(!n(t))throw new TypeError("iterator must be a function");var i;arguments.length>=3&&(i=r),"[object Array]"===o.call(e)?a(e,t,i):"string"==typeof e?s(e,t,i):u(e,t,i)}},function(e,t){function r(e,t){if(!(e=e.replace(/\t+/g," ").trim()))return null;var r=e.indexOf(" ");if(-1===r)throw new Error("no named row at line "+t);var o=e.substring(0,r);e=(e=(e=(e=e.substring(r+1)).replace(/letter=[\'\"]\S+[\'\"]/gi,"")).split("=")).map((function(e){return e.trim().match(/(".*?"|[^"\s]+)+(?=\s*|\s*$)/g)}));for(var i=[],a=0;a<e.length;a++){var s=e[a];0===a?i.push({key:s[0],data:""}):a===e.length-1?i[i.length-1].data=n(s[0]):(i[i.length-1].data=n(s[0]),i.push({key:s[1],data:""}))}var u={key:o,data:{}};return i.forEach((function(e){u.data[e.key]=e.data})),u}function n(e){return e&&0!==e.length?0===e.indexOf('"')||0===e.indexOf("'")?e.substring(1,e.length-1):-1!==e.indexOf(",")?function(e){return e.split(",").map((function(e){return parseInt(e,10)}))}(e):parseInt(e,10):""}e.exports=function(e){if(!e)throw new Error("no data provided");var t={pages:[],chars:[],kernings:[]},n=(e=e.toString().trim()).split(/\r\n?|\n/g);if(0===n.length)throw new Error("no data in BMFont file");for(var o=0;o<n.length;o++){var i=r(n[o],o);if(i)if("page"===i.key){if("number"!=typeof i.data.id)throw new Error("malformed file at line "+o+" -- needs page id=N");if("string"!=typeof i.data.file)throw new Error("malformed file at line "+o+' -- needs page file="path"');t.pages[i.data.id]=i.data.file}else"chars"===i.key||"kernings"===i.key||("char"===i.key?t.chars.push(i.data):"kerning"===i.key?t.kernings.push(i.data):t[i.key]=i.data)}return t}},function(e,t,r){var n=r(47),o=r(48),i={scaleh:"scaleH",scalew:"scaleW",stretchh:"stretchH",lineheight:"lineHeight",alphachnl:"alphaChnl",redchnl:"redChnl",greenchnl:"greenChnl",bluechnl:"blueChnl"};function a(e){return function(e){for(var t=[],r=0;r<e.attributes.length;r++)t.push(e.attributes[r]);return t}(e).reduce((function(e,t){var r;return e[(r=t.nodeName,i[r.toLowerCase()]||r)]=t.nodeValue,e}),{})}e.exports=function(e){e=e.toString();var t=o(e),r={pages:[],chars:[],kernings:[]};["info","common"].forEach((function(e){var o=t.getElementsByTagName(e)[0];o&&(r[e]=n(a(o)))}));var i=t.getElementsByTagName("pages")[0];if(!i)throw new Error("malformed file -- no <pages> element");for(var s=i.getElementsByTagName("page"),u=0;u<s.length;u++){var l=s[u],c=parseInt(l.getAttribute("id"),10),p=l.getAttribute("file");if(isNaN(c))throw new Error('malformed file -- page "id" attribute is NaN');if(!p)throw new Error('malformed file -- needs page "file" attribute');r.pages[parseInt(c,10)]=p}return["chars","kernings"].forEach((function(e){var o=t.getElementsByTagName(e)[0];if(o)for(var i=e.substring(0,e.length-1),s=o.getElementsByTagName(i),u=0;u<s.length;u++){var l=s[u];r[e].push(n(a(l)))}})),r}},function(e,t){e.exports=function(e){for(var t in"chasrset"in e&&(e.charset=e.chasrset,delete e.chasrset),e)"face"!==t&&"charset"!==t&&(e[t]="padding"===t||"spacing"===t?e[t].split(",").map((function(e){return parseInt(e,10)})):parseInt(e[t],10));return e}},function(e,t){e.exports=void 0!==self.DOMParser?function(e){return(new self.DOMParser).parseFromString(e,"application/xml")}:void 0!==self.ActiveXObject&&new self.ActiveXObject("Microsoft.XMLDOM")?function(e){var t=new self.ActiveXObject("Microsoft.XMLDOM");return t.async="false",t.loadXML(e),t}:function(e){var t=document.createElement("div");return t.innerHTML=e,t}},function(e,t){var r=[66,77,70];function n(e,t,r){if(r>t.length-1)return 0;var n=t.readUInt8(r++),i=t.readInt32LE(r);switch(r+=4,n){case 1:e.info=function(e,t){var r={};r.size=e.readInt16LE(t);var n=e.readUInt8(t+2);r.smooth=n>>7&1,r.unicode=n>>6&1,r.italic=n>>5&1,r.bold=n>>4&1,n>>3&1&&(r.fixedHeight=1);return r.charset=e.readUInt8(t+3)||"",r.stretchH=e.readUInt16LE(t+4),r.aa=e.readUInt8(t+6),r.padding=[e.readInt8(t+7),e.readInt8(t+8),e.readInt8(t+9),e.readInt8(t+10)],r.spacing=[e.readInt8(t+11),e.readInt8(t+12)],r.outline=e.readUInt8(t+13),r.face=function(e,t){return o(e,t).toString("utf8")}(e,t+14),r}(t,r);break;case 2:e.common=function(e,t){var r={};r.lineHeight=e.readUInt16LE(t),r.base=e.readUInt16LE(t+2),r.scaleW=e.readUInt16LE(t+4),r.scaleH=e.readUInt16LE(t+6),r.pages=e.readUInt16LE(t+8);e.readUInt8(t+10);return r.packed=0,r.alphaChnl=e.readUInt8(t+11),r.redChnl=e.readUInt8(t+12),r.greenChnl=e.readUInt8(t+13),r.blueChnl=e.readUInt8(t+14),r}(t,r);break;case 3:e.pages=function(e,t,r){for(var n=[],i=o(e,t),a=i.length+1,s=r/a,u=0;u<s;u++)n[u]=e.slice(t,t+i.length).toString("utf8"),t+=a;return n}(t,r,i);break;case 4:e.chars=function(e,t,r){for(var n=[],o=r/20,i=0;i<o;i++){var a={},s=20*i;a.id=e.readUInt32LE(t+0+s),a.x=e.readUInt16LE(t+4+s),a.y=e.readUInt16LE(t+6+s),a.width=e.readUInt16LE(t+8+s),a.height=e.readUInt16LE(t+10+s),a.xoffset=e.readInt16LE(t+12+s),a.yoffset=e.readInt16LE(t+14+s),a.xadvance=e.readInt16LE(t+16+s),a.page=e.readUInt8(t+18+s),a.chnl=e.readUInt8(t+19+s),n[i]=a}return n}(t,r,i);break;case 5:e.kernings=function(e,t,r){for(var n=[],o=r/10,i=0;i<o;i++){var a={},s=10*i;a.first=e.readUInt32LE(t+0+s),a.second=e.readUInt32LE(t+4+s),a.amount=e.readInt16LE(t+8+s),n[i]=a}return n}(t,r,i)}return 5+i}function o(e,t){for(var r=t;r<e.length&&0!==e[r];r++);return e.slice(t,r)}e.exports=function(e){if(e.length<6)throw new Error("invalid buffer length for BMFont");if(!r.every((function(t,r){return e.readUInt8(r)===t})))throw new Error("BMFont missing BMF byte header");var t=3;if(e.readUInt8(t++)>3)throw new Error("Only supports BMFont Binary v3 (BMFont App v1.10)");for(var o={kernings:[],chars:[]},i=0;i<5;i++)t+=n(o,e,t);return o}},function(e,t,r){(function(t){var n=r(51),o=new t([66,77,70,3]);e.exports=function(e){return"string"==typeof e?"BMF"===e.substring(0,3):e.length>4&&n(e.slice(0,4),o)}}).call(this,r(2).Buffer)},function(e,t,r){var n=r(2).Buffer;e.exports=function(e,t){if(n.isBuffer(e)&&n.isBuffer(t)){if("function"==typeof e.equals)return e.equals(t);if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}}},function(e,t,r){var n=r(53),o=r(56),i=r(57),a=r(60),s=r(13),u=r(62),l=r(63),c=THREE.BufferGeometry;function p(e){c.call(this),"string"==typeof e&&(e={text:e}),this._opt=s({},e),e&&this.update(e)}e.exports=function(e){return new p(e)},o(p,c),p.prototype.update=function(e){if("string"==typeof e&&(e={text:e}),!(e=s({},this._opt,e)).font)throw new TypeError("must specify a { font } in options");this.layout=n(e);var t=!1!==e.flipY,r=e.font,o=r.common.scaleW,l=r.common.scaleH,c=this.layout.glyphs.filter((function(e){var t=e.data;return t.width*t.height>0}));this.visibleGlyphs=c;var p=u.positions(c),f=u.uvs(c,o,l,t),h=i({clockwise:!0,type:"uint16",count:c.length});if(a.index(this,h,1,"uint16"),a.attr(this,"position",p,2),a.attr(this,"uv",f,2),!e.multipage&&"page"in this.attributes)this.removeAttribute("page");else if(e.multipage){var d=u.pages(c);a.attr(this,"page",d,1)}},p.prototype.computeBoundingSphere=function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere);var e=this.attributes.position.array,t=this.attributes.position.itemSize;if(!e||!t||e.length<2)return this.boundingSphere.radius=0,void this.boundingSphere.center.set(0,0,0);l.computeSphere(e,this.boundingSphere),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.')},p.prototype.computeBoundingBox=function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3);var e=this.boundingBox,t=this.attributes.position.array,r=this.attributes.position.itemSize;!t||!r||t.length<2?e.makeEmpty():l.computeBox(t,e)}},function(e,t,r){var n=r(54),o=r(6),i=r(55),a=["x","e","a","o","n","s","r","c","u","m","v","w","z"],s=["m","w"],u=["H","I","N","E","F","K","L","T","U","V","W","X","Y","Z"],l="\t".charCodeAt(0),c=" ".charCodeAt(0),p=0,f=1,h=2;function d(e){this.glyphs=[],this._measure=this.computeMetrics.bind(this),this.update(e)}function m(e){return new Function(["return function "+e+"() {","  return this._"+e,"}"].join("\n"))()}function g(e,t){if(!e.chars||0===e.chars.length)return null;var r=y(e.chars,t);return r>=0?e.chars[r]:null}function v(e,t,r){if(!e.kernings||0===e.kernings.length)return 0;for(var n=e.kernings,o=0;o<n.length;o++){var i=n[o];if(i.first===t&&i.second===r)return i.amount}return 0}function y(e,t,r){for(var n=r=r||0;n<e.length;n++)if(e[n].id===t)return n;return-1}e.exports=function(e){return new d(e)},d.prototype.update=function(e){if(e=o({measure:this._measure},e),this._opt=e,this._opt.tabSize=i(this._opt.tabSize,4),!e.font)throw new Error("must provide a valid bitmap font");var t=this.glyphs,r=e.text||"",s=e.font;this._setupSpaceGlyphs(s);var l=n.lines(r,e),c=e.width||0;t.length=0;var d=l.reduce((function(e,t){return Math.max(e,t.width,c)}),0),m=0,g=0,E=i(e.lineHeight,s.common.lineHeight),b=s.common.base,T=E-b,w=e.letterSpacing||0,R=E*l.length-T,x=function(e){if("center"===e)return f;if("right"===e)return h;return p}(this._opt.align);g-=R,this._width=d,this._height=R,this._descender=E-b,this._baseline=b,this._xHeight=function(e){for(var t=0;t<a.length;t++){var r=a[t].charCodeAt(0),n=y(e.chars,r);if(n>=0)return e.chars[n].height}return 0}(s),this._capHeight=function(e){for(var t=0;t<u.length;t++){var r=u[t].charCodeAt(0),n=y(e.chars,r);if(n>=0)return e.chars[n].height}return 0}(s),this._lineHeight=E,this._ascender=E-T-this._xHeight;var _=this;l.forEach((function(e,n){for(var o,i=e.start,a=e.end,u=e.width,l=i;l<a;l++){var c=r.charCodeAt(l),p=_.getGlyph(s,c);if(p){o&&(m+=v(s,o.id,p.id));var y=m;x===f?y+=(d-u)/2:x===h&&(y+=d-u),t.push({position:[y,g],data:p,index:l,line:n}),m+=p.xadvance+w,o=p}}g+=E,m=0})),this._linesTotal=l.length},d.prototype._setupSpaceGlyphs=function(e){if(this._fallbackSpaceGlyph=null,this._fallbackTabGlyph=null,e.chars&&0!==e.chars.length){var t=g(e,c)||function(e){for(var t=0;t<s.length;t++){var r=s[t].charCodeAt(0),n=y(e.chars,r);if(n>=0)return e.chars[n]}return 0}(e)||e.chars[0],r=this._opt.tabSize*t.xadvance;this._fallbackSpaceGlyph=t,this._fallbackTabGlyph=o(t,{x:0,y:0,xadvance:r,id:l,xoffset:0,yoffset:0,width:0,height:0})}},d.prototype.getGlyph=function(e,t){var r=g(e,t);return r||(t===l?this._fallbackTabGlyph:t===c?this._fallbackSpaceGlyph:null)},d.prototype.computeMetrics=function(e,t,r,n){var o,i=this._opt.letterSpacing||0,a=this._opt.font,s=0,u=0,l=0;if(!a.chars||0===a.chars.length)return{start:t,end:t,width:0};r=Math.min(e.length,r);for(var c=t;c<r;c++){var p,f=e.charCodeAt(c);if(p=this.getGlyph(a,f)){p.xoffset;var h=(s+=o?v(a,o.id,p.id):0)+p.xadvance+i,d=s+p.width;if(d>=n||h>=n)break;s=h,u=d,o=p}l++}return o&&(u+=o.xoffset),{start:t,end:t+l,width:u}},["width","height","descender","ascender","xHeight","baseline","capHeight","lineHeight"].forEach((function(e){Object.defineProperty(d.prototype,e,{get:m(e),configurable:!0})}))},function(e,t){var r=/\n/,n="\n",o=/\s/;function i(e,t,r,n){var o=e.indexOf(t,r);return-1===o||o>n?n:o}function a(e){return o.test(e)}function s(e,t,r,n){return{start:t,end:t+Math.min(n,r-t)}}e.exports=function(t,r){return e.exports.lines(t,r).map((function(e){return t.substring(e.start,e.end)})).join("\n")},e.exports.lines=function(e,t){if(0===(t=t||{}).width&&"nowrap"!==t.mode)return[];e=e||"";var o="number"==typeof t.width?t.width:Number.MAX_VALUE,u=Math.max(0,t.start||0),l="number"==typeof t.end?t.end:e.length,c=t.mode,p=t.measure||s;return"pre"===c?function(e,t,n,o,i){for(var a=[],s=n,u=n;u<o&&u<t.length;u++){var l=t.charAt(u),c=r.test(l);if(c||u===o-1){var p=e(t,s,c?u:u+1,i);a.push(p),s=u+1}}return a}(p,e,u,l,o):function(e,t,r,o,s,u){var l=[],c=s;"nowrap"===u&&(c=Number.MAX_VALUE);for(;r<o&&r<t.length;){for(var p=i(t,n,r,o);r<p&&a(t.charAt(r));)r++;var f=e(t,r,p,c),h=r+(f.end-f.start),d=h+n.length;if(h<p){for(;h>r&&!a(t.charAt(h));)h--;if(h===r)d>r+n.length&&d--,h=d;else for(d=h;h>r&&a(t.charAt(h-n.length));)h--}if(h>=r){var m=e(t,r,h,c);l.push(m)}r=d}return l}(p,e,u,l,o,c)}},function(e,t){e.exports=function(e,t){return"number"==typeof e?e:"number"==typeof t?t:0}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}},function(e,t,r){var n=r(12),o=r(58),i=r(59),a=[0,2,3],s=[2,1,3];e.exports=function(e,t){e&&(o(e)||i(e))||(t=e||{},e=null);for(var r="string"==typeof(t="number"==typeof t?{count:t}:t||{}).type?t.type:"uint16",u="number"==typeof t.count?t.count:1,l=t.start||0,c=!1!==t.clockwise?a:s,p=c[0],f=c[1],h=c[2],d=6*u,m=e||new(n(r))(d),g=0,v=0;g<d;g+=6,v+=4){var y=g+l;m[y+0]=v+0,m[y+1]=v+1,m[y+2]=v+2,m[y+3]=v+p,m[y+4]=v+f,m[y+5]=v+h}return m}},function(e,t){var r=Object.prototype.toString;e.exports=function(e){return e.BYTES_PER_ELEMENT&&"[object ArrayBuffer]"===r.call(e.buffer)||Array.isArray(e)}},function(e,t){function r(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
e.exports=function(e){return null!=e&&(r(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&r(e.slice(0,0))}(e)||!!e._isBuffer)}},function(e,t,r){var n=r(61),o=!1;function i(e,t,r,i){if(t=t||[],!e||function(e,t,r){if(e.itemSize!==r)return!0;if(!e.array)return!0;var n=e.array.length;return Array.isArray(t)&&Array.isArray(t[0])?n!==t.length*r:n!==t.length}(e,t,r)){t=n(t,i);var a=e&&"function"!=typeof e.setArray;return e&&!a||(a&&!o&&(o=!0,console.warn(["A WebGL buffer is being updated with a new size or itemSize, ","however this version of ThreeJS only supports fixed-size buffers.","\nThe old buffer may still be kept in memory.\n","To avoid memory leaks, it is recommended that you dispose ","your geometries and create new ones, or update to ThreeJS r82 or newer.\n","See here for discussion:\n","https://github.com/mrdoob/three.js/pull/9631"].join(""))),e=new THREE.BufferAttribute(t,r)),e.itemSize=r,e.needsUpdate=!0,"function"==typeof e.setArray&&e.setArray(t),e}return n(t,e.array),e.needsUpdate=!0,null}e.exports.attr=function(e,t,r,n,o){"number"!=typeof n&&(n=3);"string"!=typeof o&&(o="float32");if(Array.isArray(r)&&Array.isArray(r[0])&&r[0].length!==n)throw new Error("Nested vertex array has unexpected size; expected "+n+" but found "+r[0].length);var a=i(e.getAttribute(t),r,n,o);a&&e.addAttribute(t,a)},e.exports.index=function(e,t,r,n){"number"!=typeof r&&(r=1);"string"!=typeof n&&(n="uint16");var o=!e.index&&"function"!=typeof e.setIndex,a=i(o?e.getAttribute("index"):e.index,t,r,n);a&&(o?e.addAttribute("index",a):e.index=a)}},function(e,t,r){var n=r(12);e.exports=function(e,t,r){if(!e)throw new TypeError("must specify data as first parameter");if(r=0|+(r||0),Array.isArray(e)&&e[0]&&"number"==typeof e[0][0]){var o,i,a,s,u=e[0].length,l=e.length*u;t&&"string"!=typeof t||(t=new(n(t||"float32"))(l+r));var c=t.length-r;if(l!==c)throw new Error("source length "+l+" ("+u+"x"+e.length+") does not match destination length "+c);for(o=0,a=r;o<e.length;o++)for(i=0;i<u;i++)t[a++]=null===e[o][i]?NaN:e[o][i]}else if(t&&"string"!=typeof t)t.set(e,r);else{var p=n(t||"float32");if(Array.isArray(e)||"array"===t)for(t=new p(e.length+r),o=0,a=r,s=t.length;a<s;a++,o++)t[a]=null===e[o]?NaN:e[o];else 0===r?t=new p(e):(t=new p(e.length+r)).set(e,r)}return t}},function(e,t){e.exports.pages=function(e){var t=new Float32Array(4*e.length*1),r=0;return e.forEach((function(e){var n=e.data.page||0;t[r++]=n,t[r++]=n,t[r++]=n,t[r++]=n})),t},e.exports.uvs=function(e,t,r,n){var o=new Float32Array(4*e.length*2),i=0;return e.forEach((function(e){var a=e.data,s=a.x+a.width,u=a.y+a.height,l=a.x/t,c=a.y/r,p=s/t,f=u/r;n&&(c=(r-a.y)/r,f=(r-u)/r),o[i++]=l,o[i++]=c,o[i++]=l,o[i++]=f,o[i++]=p,o[i++]=f,o[i++]=p,o[i++]=c})),o},e.exports.positions=function(e){var t=new Float32Array(4*e.length*2),r=0;return e.forEach((function(e){var n=e.data,o=e.position[0]+n.xoffset,i=e.position[1]+n.yoffset,a=n.width,s=n.height;t[r++]=o,t[r++]=i,t[r++]=o,t[r++]=i+s,t[r++]=o+a,t[r++]=i+s,t[r++]=o+a,t[r++]=i})),t}},function(e,t){var r=2,n={min:[0,0],max:[0,0]};function o(e){var t=e.length/r;n.min[0]=e[0],n.min[1]=e[1],n.max[0]=e[0],n.max[1]=e[1];for(var o=0;o<t;o++){var i=e[o*r+0],a=e[o*r+1];n.min[0]=Math.min(i,n.min[0]),n.min[1]=Math.min(a,n.min[1]),n.max[0]=Math.max(i,n.max[0]),n.max[1]=Math.max(a,n.max[1])}}e.exports.computeBox=function(e,t){o(e),t.min.set(n.min[0],n.min[1],0),t.max.set(n.max[0],n.max[1],0)},e.exports.computeSphere=function(e,t){o(e);var r=n.min[0],i=n.min[1],a=n.max[0]-r,s=n.max[1]-i,u=Math.sqrt(a*a+s*s);t.center.set(r+a/2,i+s/2,0),t.radius=u/2}},function(e,t,r){var n=r(13);e.exports=function(e){var t="number"==typeof(e=e||{}).opacity?e.opacity:1,r="number"==typeof e.alphaTest?e.alphaTest:1e-4,o=e.precision||"highp",i=e.color,a=e.map,s="boolean"!=typeof e.negate||e.negate;return delete e.map,delete e.color,delete e.precision,delete e.opacity,delete e.negate,n({uniforms:{opacity:{type:"f",value:t},map:{type:"t",value:a||new THREE.Texture},color:{type:"c",value:new THREE.Color(i)}},vertexShader:["attribute vec2 uv;","attribute vec4 position;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * position;","}"].join("\n"),fragmentShader:["#ifdef GL_OES_standard_derivatives","#extension GL_OES_standard_derivatives : enable","#endif","precision "+o+" float;","uniform float opacity;","uniform vec3 color;","uniform sampler2D map;","varying vec2 vUv;","float median(float r, float g, float b) {","  return max(min(r, g), min(max(r, g), b));","}","void main() {","  vec3 sample = "+(s?"1.0 - ":"")+"texture2D(map, vUv).rgb;","  float sigDist = median(sample.r, sample.g, sample.b) - 0.5;","  float alpha = clamp(sigDist/fwidth(sigDist) + 0.5, 0.0, 1.0);","  gl_FragColor = vec4(color.xyz, alpha * opacity);",0===r?"":"  if (gl_FragColor.a < "+r+") discard;","}"].join("\n")},e)}},function(e,t,r){"use strict";r.r(t);var n={};r.r(n),r.d(n,"setup",(function(){return oe})),r.d(n,"enter",(function(){return ie})),r.d(n,"exit",(function(){return ae})),r.d(n,"execute",(function(){return se}));var o={};r.r(o),r.d(o,"setup",(function(){return ve})),r.d(o,"enter",(function(){return ye})),r.d(o,"exit",(function(){return Ee})),r.d(o,"execute",(function(){return be})),r.d(o,"onSelectEnd",(function(){return Te}));var a={};r.r(a),r.d(a,"setup",(function(){return we})),r.d(a,"enter",(function(){return Re})),r.d(a,"exit",(function(){return xe})),r.d(a,"execute",(function(){return _e}));var s={};r.r(s),r.d(s,"setup",(function(){return Se})),r.d(s,"enter",(function(){return Me})),r.d(s,"exit",(function(){return Ae})),r.d(s,"execute",(function(){return He}));var u={};r.r(u),r.d(u,"setup",(function(){return je})),r.d(u,"enter",(function(){return Ue})),r.d(u,"exit",(function(){return Fe})),r.d(u,"execute",(function(){return ke}));var l={};r.r(l),r.d(l,"setup",(function(){return Ye})),r.d(l,"enter",(function(){return We})),r.d(l,"exit",(function(){return Ke})),r.d(l,"execute",(function(){return qe}));r(14);var c={createButton:function(e,t){function r(t){a.style.display="",a.style.cursor="pointer",a.style.left="calc(50% - 50px)",a.style.width="100px",a.textContent="ENTER VR",a.onmouseenter=function(){a.style.opacity="1.0"},a.onmouseleave=function(){a.style.opacity="0.5"},a.onclick=function(){t.isPresenting?t.exitPresent():t.requestPresent([{source:e.domElement}])},e.vr.setDevice(t)}function n(){a.style.display="",a.style.cursor="auto",a.style.left="calc(50% - 75px)",a.style.width="150px",a.onmouseenter=null,a.onmouseleave=null,a.onclick=null}function o(){n(),a.textContent="VR NOT FOUND",e.vr.setDevice(null)}function i(e){e.style.position="absolute",e.style.bottom="20px",e.style.padding="12px 6px",e.style.border="1px solid #fff",e.style.borderRadius="4px",e.style.background="rgba(0,0,0,0.1)",e.style.color="#fff",e.style.font="normal 13px sans-serif",e.style.textAlign="center",e.style.opacity="0.5",e.style.outline="none",e.style.zIndex="999"}var a;if(t&&t.referenceSpaceType&&e.vr.setReferenceSpaceType(t.referenceSpaceType),"xr"in navigator&&"supportsSession"in navigator.xr)return(a=document.createElement("button")).style.display="none",i(a),navigator.xr.supportsSession("immersive-vr").then((function(){var t=null;function r(r){r.addEventListener("end",n),e.vr.setSession(r),a.textContent="EXIT XR",t=r}function n(){t.removeEventListener("end",n),e.vr.setSession(null),a.textContent="ENTER XR",t=null}a.style.display="",a.style.cursor="pointer",a.style.left="calc(50% - 50px)",a.style.width="100px",a.textContent="ENTER XR",a.onmouseenter=function(){a.style.opacity="1.0"},a.onmouseleave=function(){a.style.opacity="0.5"},a.onclick=function(){null===t?navigator.xr.requestSession("immersive-vr").then(r):t.end()}})).catch((function(){n(),a.textContent="XR NOT FOUND"})),a;if("getVRDisplays"in navigator)return(a=document.createElement("button")).style.display="none",i(a),window.addEventListener("vrdisplayconnect",(function(e){r(e.display)}),!1),window.addEventListener("vrdisplaydisconnect",(function(){o()}),!1),window.addEventListener("vrdisplaypresentchange",(function(e){a.textContent=e.display.isPresenting?"EXIT VR":"ENTER VR"}),!1),window.addEventListener("vrdisplayactivate",(function(t){t.display.requestPresent([{source:e.domElement}])}),!1),navigator.getVRDisplays().then((function(e){e.length>0?r(e[0]):o()})).catch(o),a;var s=document.createElement("a");return s.href="https://webvr.info",s.innerHTML="WEBVR NOT SUPPORTED",s.style.left="calc(50% - 90px)",s.style.width="180px",s.style.textDecoration="none",i(s),s}};r(15),r(16);const p="../src/vendor/";function f(e){for(var t in e)if("string"==typeof e[t])return!1;return!0}r(17);var h=[],d=new THREE.Box3,m=new THREE.Vector3,g=null;const v=2;function y(e){if(!e||!e.grabbing)return;let t=e.grabbing;t.position.copy(e.position),g.add(t),t.userData.grabbedBy=null,t.userData.animation=1,e.grabbing=null,E(e,!0)}function E(e,t){for(var r=0;r<e.children.length;r++)e.children[r].visible=t}var b,T={object:null,widget:null,controller:null,animation:0};const w=["seurat","sorolla","bosch","degas","rembrandt"],R=[1,1,1.875,1,1];function x(e,t,r){T.painting&&function(e){T.animation<1&&(T.animation+=(1-T.animation)*e*4);const t=T.controller;t.getWorldPosition(_),t.getWorldDirection(S),S.negate(),t.raycaster.set(_,S);var r=t.raycaster.intersectObject(b,!0);if(0==r.length||r[0].object!==T.painting)return;L(r[0])}(t)}var _=new THREE.Vector3,S=new THREE.Vector3;var M=new THREE.Vector2,A=new THREE.Vector2;const H=.05;function L(e){T.widget.position.copy(e.point),T.widget.position.x-=.3*T.animation;const t=T.widget.geometry.faceVertexUvs[0],r=R[T.painting.userData.paintingId];e.uv.clampScalar(H,1-H),M.set(e.uv.x-H,e.uv.y+H*r),A.set(e.uv.x+H,e.uv.y-H*r),t[0][0].x=M.x,t[0][0].y=A.y,t[0][1].x=M.x,t[0][1].y=M.y,t[0][2].x=A.x,t[0][2].y=A.y,t[1][0].x=M.x,t[1][0].y=M.y,t[1][1].x=A.x,t[1][1].y=M.y,t[1][2].x=A.x,t[1][2].y=A.y,T.widget.geometry.uvsNeedUpdate=!0}r(18);var P=r(52),B=r(64);class O extends THREE.Object3D{constructor(e){if(super(),!e.font)return void console.warn("createText(): <font> not defined");if(!e.map)return void console.warn("createText(): texture <map> not defined");this.width=e.width||300,this.size=e.size||1,this.align=e.align||"left",this.color=e.color||16777215,this.anchor=e.anchor||e.align,this.baseline=e.baseline||"bottom",this.negate=!0===e.negate,this.geometry=P({width:this.width,align:this.align,font:e.font}),this.material=new THREE.RawShaderMaterial(B({map:e.map,color:this.color,negate:this.negate}));const t=new THREE.Mesh(this.geometry,this.material);t.scale.set(.001*this.size,.001*this.size,1),t.rotation.x=Math.PI/2,this.add(t),this.value=e.value||"[TEXT]"}set value(e){this.geometry.update(e);const t=this.geometry.layout;let r=0,n=0;"top"===this.baseline?n=t._height+t._ascender:"center"===this.baseline&&(n=t._height/2),"right"===this.anchor?r=-t._width:"center"===this.anchor&&(r=-t._width/2),0===r&&0===n||this.geometry.translate(r,n,0)}}var I={url:"assets/tweets.json",hashtag:"#helloWebXR.",hashtagText:null,authorText:null,messageText:null,news:[],current:0};function C(){const e=I;e.authorText.value=e.news[e.current].author,e.messageText.value=e.news[e.current].message,e.current=(e.current+1)%e.news.length,setTimeout(C,3e3)}class D extends THREE.Object3D{constructor(e,t){super(),this.listener=e,this.context=e.context,this.poolSize=t||5;for(var r=0;r<this.poolSize;r++)this.children.push(new THREE.PositionalAudio(e))}setBuffer(e){this.children.forEach(t=>{t.setBuffer(e)})}play(){var e=!1;for(let t=0;t<this.children.length;t++){let r=this.children[t];r.isPlaying||!r.buffer||e||(r.play(),r.isPaused=!1,e=!0)}e||console.warn("All the sounds are playing. If you need to play more sounds simultaneously consider increasing the pool size")}}var j,U=[null,null],F=[null,null],k=new Array(13),N=new THREE.Box3,G=new THREE.Vector3,$=13,V=[new Array($).fill(!1),new Array($).fill(!1)];class Y{constructor(e,t){this.geometry=new THREE.BufferGeometry,this.vertices=new Float32Array(3*e*2),this.uvs=new Float32Array(2*e*2),this.width=t,this.geometry.addAttribute("position",new THREE.BufferAttribute(this.vertices,3).setDynamic(!0)),this.material=new THREE.MeshBasicMaterial({side:THREE.DoubleSide,color:16711680}),this.mesh=new THREE.Mesh(this.geometry,this.material),this.mesh.drawMode=THREE.TriangleStripDrawMode,this.mesh.frustumCulled=!1,this.mesh.vertices=this.vertices,this.direction=new THREE.Vector3,this.numPoints=e}setDirection(e){var t=new THREE.Vector3(0,1,0);this.direction.copy(e).cross(t).normalize().multiplyScalar(this.width/2)}setWidth(e){this.width=e}setPoint(){var e=new THREE.Vector3,t=new THREE.Vector3;e.copy(point).add(this.direction),t.copy(point).sub(this.direction);var r=6*i;this.vertices[r++]=e.x,this.vertices[r++]=e.y,this.vertices[r++]=e.z,this.vertices[r++]=t.x,this.vertices[r++]=t.y,this.vertices[r++]=t.z,this.geometry.attributes.position.needsUpdate=!0}}new THREE.Matrix4;class z{constructor(e,t){this.ctx=e,this.teleportEntity=new THREE.Group,this.active=!1,this.teleportHitGeometry=new THREE.Mesh(new THREE.IcosahedronBufferGeometry(.3,1),new THREE.MeshBasicMaterial({color:16776960,wireframe:!0})),this.ballColliding=new THREE.Mesh(new THREE.IcosahedronBufferGeometry(.02,1),new THREE.MeshBasicMaterial({color:16777215})),this.ballColliding.visible=!1,this.teleportEntity.add(this.ballColliding),this.teleportHitGeometry.visible=!1,this.teleportHitGeometry.position.set(-2,0,-2),this.teleportEntity.add(this.teleportHitGeometry),this.ctx.scene.add(this.teleportEntity)}onSelectStart(){evt.target===this.ctx.controllers[0]&&(this.active=!0)}onHoverLeave(){this.ballColliding.visible=!1,this.teleportHitGeometry.visible=!1}onHover(e,t){t?(this.teleportHitGeometry.visible=!0,this.teleportHitGeometry.position.copy(e),this.hit=!0,this.ballColliding.visible=!1):(this.ballColliding.visible=!0,this.ballColliding.position.copy(e))}onSelectEnd(e){this.ctx.cameraRig.position.copy(e),this.teleportHitGeometry.visible=!1,this.active=!1}createLine(e){return new Y("line"===e.type?2:e.curveNumberPoints,e.curveLineWidth)}}var X,W,K,q,J,Z,Q,ee,te=new THREE.Matrix4;class re{addState(e,t,r){this.states[e]=t,t.targetPoint=new THREE.Vector3,t.hit=!1,!0===r&&this.currentStates.push(t)}activateState(e){this.states[e]&&this.currentStates.push(this.states[e])}deactivateState(e){this.currentStates.splice(this.currentStates.indexOf(e),1)}constructor(e){this.ctx=e,this.raycaster=new THREE.Raycaster,this.states={},this.currentStates=[],this.active=!1;var t=(new THREE.BufferGeometry).setFromPoints([new THREE.Vector3(0,0,0),new THREE.Vector3(0,0,-1)]),r=new THREE.LineBasicMaterial({color:255}),n=new THREE.Line(t,r);n.name="line",this.rayLength=5,n.scale.z=this.rayLength,this.line0=n.clone(),this.line1=n.clone(),this.line0.visible=this.line1.visible=!0,e.controllers[0].add(this.line0)}onSelectStart(e){e.target===this.ctx.controllers[0]&&(this.active=!0)}execute(e,t,r){0!==this.currentStates.length&&this.currentStates.forEach(t=>{var r=e.controllers[0],n=this.getIntersections(r,t.colliderMesh);if(n.length>0){let e=n[0];t.targetPoint.copy(e.point),t.hit=!0,t.onHover(t.targetPoint,this.active),this.line0.scale.z=e.distance}else t.hit&&(t.onHoverLeave(),t.hit=!1),this.line0.scale.z=this.rayLength})}getIntersections(e,t){return te.identity().extractRotation(e.matrixWorld),this.raycaster.ray.origin.setFromMatrixPosition(e.matrixWorld),this.raycaster.ray.direction.set(0,0,-1).applyMatrix4(te),this.raycaster.intersectObject(t,!0)}onSelectEnd(){this.active&&(this.currentStates.forEach(e=>{e.hit&&(e.onSelectEnd(e.targetPoint),e.hit=!1)}),this.active=!1)}createLine(e){return new RayCurve("line"===e.type?2:e.curveNumberPoints,e.curveLineWidth)}}function ne(e){return e.assets.doorfx_tex.wrapT=THREE.RepeatWrapping,e.assets.doorfx_tex.wrapS=THREE.RepeatWrapping,new THREE.ShaderMaterial({uniforms:{time:{value:0},selected:{value:0},tex:{value:e.assets.doorfx_tex}},vertexShader:e.shaders.basic_vert,fragmentShader:e.shaders.door_frag})}function oe(e){const t=e.assets;X=new THREE.Object3D;const r=t.lightmap_tex;r.encoding=THREE.sRGBEncoding,r.flipY=!1;const n=t.sky_tex;n.encoding=THREE.sRGBEncoding,n.flipY=!1;const o=t.clouds_tex;o.encoding=THREE.sRGBEncoding,o.flipY=!1;const i=new THREE.MeshBasicMaterial({map:r});Q={hall:i,xylophone:i,"xylostick-left":i,"xylostick-right":i,"xylostickball-left":i,"xylostickball-right":i,lightpanels:new THREE.MeshBasicMaterial,doorA:ne(e),doorB:ne(e),doorC:ne(e),doorD:ne(e),sky:new THREE.MeshBasicMaterial({map:n}),clouds:new THREE.MeshBasicMaterial({map:o,transparent:!0})},(W=t.hall_model.scene).traverse(e=>{if("teleport"==e.name)return K=e,void(e.material.visible=!1);"Mesh"==e.type&&Q[e.name]&&(e.material=Q[e.name])}),function(e,t){for(let r in w){let n=w[r],o=t.getObjectByName(n);if(!o)continue;let i=e.assets[`painting_${n}_tex`];i.encoding=THREE.sRGBEncoding,i.flipY=!1,o.material=new THREE.MeshBasicMaterial({map:i}),o.userData.paintingId=r}b=t.getObjectByName("paintings"),T.widget=new THREE.Mesh(new THREE.PlaneGeometry,new THREE.MeshBasicMaterial({color:16711680})),T.widget.geometry.rotateY(-Math.PI/2),T.widget.visible=!1,e.scene.add(T.widget)}(e,W),function(e,t){const r=new THREE.AudioLoader;j=new THREE.AudioListener,t;for(let e=0;e<$;e++){let n="xnote0"+(e<10?"0"+e:e),o=t.getObjectByName(n);o.geometry.computeBoundingBox(),o.geometry.boundingBox.translate(o.position).translate(o.parent.position),o.material=new THREE.MeshLambertMaterial,o.material.color.setHSL(e/13,.9,.2),o.material.emissive=o.material.color.clone(),o.material.emissiveIntensity=0,k[e]=o,o.userData.animation=0,o.userData.resetY=o.position.y,o.userData.sound=new D(j,10),r.load("assets/ogg/xylophone"+e+".ogg",e=>{o.userData.sound.setBuffer(e)})}U[0]=t.getObjectByName("xylostick-left"),U[1]=t.getObjectByName("xylostick-right"),U[0].userData.resetPosition=U[0].position.clone(),U[1].userData.resetPosition=U[1].position.clone(),U[0].userData.resetRotation=U[0].rotation.clone(),U[1].userData.resetRotation=U[1].rotation.clone(),U[0].userData.grabbedBy=null,U[1].userData.grabbedBy=null,U[0].userData.animation=0,U[1].userData.animation=0,F[0]=t.getObjectByName("xylostickball-left"),F[1]=t.getObjectByName("xylostickball-right"),F[0].geometry.computeBoundingBox(),F[1].geometry.computeBoundingBox()}(0,W),function(e,t){const r=t.getObjectByName("newsticker");I.hashtagText=new O({font:e.assets.inter_bold_font,map:e.assets.inter_bold_tex,size:2,align:"right",anchor:"right",width:350,color:14327894}),I.authorText=new O({font:e.assets.inter_bold_font,map:e.assets.inter_bold_tex,size:2,width:500,color:6798541}),I.messageText=new O({font:e.assets.inter_regular_font,map:e.assets.inter_regular_tex,size:2.6,width:900,baseline:"top",color:16777215}),["hashtag","author","message"].forEach(e=>{r.add(I[`${e}Text`]),I[`${e}Text`].rotation.set(-Math.PI/2,Math.PI,0),I[`${e}Text`].position.copy(t.getObjectByName(e).position)}),I.hashtagText.value=I.hashtag,fetch(I.url).then(e=>e.json()).then(e=>{I.news=e,C()})}(e,W),function(e,t){const r=e.assets;g=t,new THREE.SphereBufferGeometry(.15,30,20),r.panoballfx_tex.wrapT=THREE.RepeatWrapping,r.panoballfx_tex.wrapS=THREE.RepeatWrapping;for(var n=0;n<v;n++){let i=r[`pano${n+1}small`];i.encoding=THREE.sRGBEncoding;var o=new THREE.Mesh(new THREE.SphereBufferGeometry(.15,30,20),new THREE.ShaderMaterial({uniforms:{time:{value:0},tex:{value:i},texfx:{value:r.panoballfx_tex}},vertexShader:e.shaders.panoball_vert,fragmentShader:e.shaders.panoball_frag,side:THREE.BackSide}));o.position.copy(t.getObjectByName(`panoball${n+1}`).position),o.userData.grabbedBy=null,o.userData.animation=0,o.userData.panoId=n,o.userData.resetPosition=o.position.clone(),h.push(o),t.add(o)}}(e,W),J=new z(e),(Z=new re(e)).addState("teleport",{colliderMesh:K,onHover:(e,t)=>{J.onHover(e,t)},onHoverLeave:()=>{J.onHoverLeave()},onSelectStart:e=>{J.onSelectStart(e)},onSelectEnd:e=>{J.onSelectEnd(e)}},!0);const a=new THREE.DirectionalLight(15663103);a.position.set(.2,1,.1);const s=new THREE.DirectionalLight(16773358,.3);s.position.set(-.2,-1,-.1),(q=new THREE.Mesh(new THREE.PlaneBufferGeometry,new THREE.MeshBasicMaterial({color:0,transparent:!0,depthTest:!1}))).position.z=-.1,q.material.opacity=0,X.add(a),X.add(s),X.add(W),e.camera.add(q)}function ie(e){e.renderer.setClearColor(12640251),(ee=e.controllers)[0].addEventListener("selectstart",ue),ee[0].addEventListener("selectend",le),ee[1].addEventListener("selectstart",ue),ee[1].addEventListener("selectend",le),e.scene.add(X),function(e){e.camera.add(j)}(e),"selectEnd"==e.message.text&&y(e.message.data)}function ae(e){e.scene.remove(X),e.controllers[0].removeEventListener("selectstart",ue),e.controllers[0].removeEventListener("selectend",le),e.controllers[1].removeEventListener("selectstart",ue),e.controllers[1].removeEventListener("selectend",le),function(e){e.camera.remove(j)}(e)}function se(e,t,r){!function(e,t,r){for(let e=0;e<h.length;e++){const n=h[e];n.visible=!0,n.userData.grabbedBy?n.position.y=.02*Math.cos(e+3*r):(n.position.copy(n.userData.resetPosition),n.position.y=1.5+.02*Math.cos(e+3*r)),n.userData.animation>0&&(n.userData.animation=Math.max(0,n.userData.animation-4*t),m.copy(n.userData.resetPosition),m.addScaledVector(n.position,-n.userData.animation),n.position.add(m))}for(let t=0;t<e.controllers.length;t++){let r=e.controllers[t];if(!r.grabbing)continue;if(e.camera.position.distanceTo(r.position)<.2)return r.grabbing.visible=!1,void(e.goto="panorama"+r.grabbing.userData.panoId)}}(e,t,r),x(0,t),function(e,t,r,n){for(var o=0;o<2;o++)if(null!==n[o].grabbing){N.setFromObject(F[o]).expandByScalar(-.01);for(var i=0;i<k.length;i++){let e=k[i];e.userData.animation>0&&(e.userData.animation=Math.max(0,e.userData.animation-4*t),e.material.emissiveIntensity=e.userData.animation,e.position.y=e.userData.resetY-.005*e.userData.animation),N.intersectsBox(e.geometry.boundingBox)?V[o][i]||(V[o][i]=!0,e.userData.sound.play(),e.userData.animation=1):V[o][i]=!1}U[o].userData.animation>0&&(U[o].userData.animation=Math.max(0,U[o].userData.animation-4*t),G.copy(U[o].userData.resetPosition),G.addScaledVector(U[o].position,-U[o].userData.animation),U[o].position.add(G))}}(0,t,0,ee),Z.execute(e,t,r),function(e){Q.doorA.uniforms.time.value=e,Q.doorB.uniforms.time.value=e,Q.doorC.uniforms.time.value=e,Q.doorD.uniforms.time.value=e,Q.doorD.uniforms.selected.value=1,function(e){h[0].material.uniforms.time.value=e,h[1].material.uniforms.time.value=e}(e)}(r),function(e){const t=e.camera.position;var r=0;t.y<.25?r=1-t.y/.25:t.x<-5.4?r=(-t.x-5.4)/.25:t.x>8?r=(t.x-8)/.25:t.z<-6.45?r=(-t.z- -6.45)/.25:t.z>6.4&&(r=(t.z-6.4)/.25);q.material.opacity=Math.min(1,Math.max(0,r))}(e)}function ue(e){(function(e){let t=e.target;if(null===t.grabbing){for(let e=0;e<h.length;e++)if(d.setFromObject(h[e]),t.boundingBox.intersectsBox(d)){if(h[e].userData.grabbedBy)return;return E(t,!1),h[e].position.set(0,0,0),h[e].rotation.set(0,0,0),t.add(h[e]),t.grabbing=h[e],h[e].userData.grabbedBy=t,!1}return!0}})(e)&&Z.onSelectStart(e)}function le(e){(function(e){let t=e.target;return null===t.grabbing||(y(t),!1)})(e)&&Z.onSelectEnd(e)}var ce,pe,fe,he,de,me=null,ge=null;function ve(e){const t=e.assets,r=new THREE.SphereBufferGeometry(5e3,60,40);t.pano1.encoding=THREE.sRGBEncoding;const n=new THREE.MeshBasicMaterial({map:t.pano1,side:THREE.BackSide});me=new THREE.Mesh(r,n)}function ye(e){e.renderer.setClearColor(0),e.scene.add(me);for(var t=0;t<e.controllers.length;t++){if(e.camera.position.distanceTo(e.controllers[t].position)<.2){(ge=e.controllers[t]).addEventListener("selectend",Te);break}}ce=!1}function Ee(e){e.scene.remove(me),ge.removeEventListener("selectend",Te)}function be(e,t,r){if(!ge||ce)return ce&&(e.message.text="selectEnd",e.message.data=ge),void(e.goto="hall");e.camera.position.distanceTo(ge.position)>.5&&(e.goto="hall")}function Te(e){ce=!0}function we(e){const t=e.assets,r=new THREE.SphereBufferGeometry(5e3,60,40);t.andesL.encoding=THREE.sRGBEncoding,t.andesR.encoding=THREE.sRGBEncoding;const n=new THREE.MeshBasicMaterial({map:t.andesR,side:THREE.BackSide}),o=new THREE.MeshBasicMaterial({map:t.andesL,side:THREE.BackSide});(pe=new THREE.Mesh(r,n)).layers.set(1),(fe=new THREE.Mesh(r,o)).layers.set(2)}function Re(e){e.renderer.setClearColor(0),e.scene.add(pe),e.scene.add(fe),e.camera.layers.enable(1)}function xe(e){e.scene.remove(pe),e.scene.remove(fe),e.camera.layers.disable(1)}function _e(e,t,r){}function Se(e){const t=e.assets;he=t.pg_object_model.scene,t.pg_object_tex.encoding=THREE.sRGBEncoding,t.pg_object_tex.flipY=!1,t.pg_floor_tex.encoding=THREE.sRGBEncoding,t.pg_floor_tex.flipY=!1,t.pg_floor_lm_tex.encoding=THREE.sRGBEncoding,t.pg_floor_lm_tex.flipY=!1,t.pg_floor_tex.wrapS=THREE.RepeatWrapping,t.pg_floor_tex.wrapT=THREE.RepeatWrapping,t.pg_bg_tex.encoding=THREE.sRGBEncoding,t.pg_bg_tex.flipY=!1,t.pg_flare_tex.encoding=THREE.sRGBEncoding,t.pg_flare_tex.flipY=!1,t.pg_panel_tex.encoding=THREE.sRGBEncoding,t.pg_panel_tex.flipY=!1,t.pg_door_lm_tex.encoding=THREE.sRGBEncoding,t.pg_door_lm_tex.flipY=!1,he.getObjectByName("object").material=new THREE.MeshBasicMaterial({map:t.pg_object_tex}),he.getObjectByName("floor").material=new THREE.MeshBasicMaterial({map:t.pg_floor_tex,lightMap:t.pg_floor_lm_tex}),he.getObjectByName("bg").material=new THREE.MeshBasicMaterial({map:t.pg_bg_tex}),he.getObjectByName("flare").material=new THREE.MeshBasicMaterial({map:t.pg_flare_tex,blending:THREE.AdditiveBlending}),he.getObjectByName("panel").material=new THREE.MeshBasicMaterial({map:t.pg_panel_tex}),he.getObjectByName("door_frame").material=new THREE.MeshBasicMaterial({map:t.pg_door_lm_tex}),de=function(e){return e.assets.doorfx_tex.wrapT=THREE.RepeatWrapping,e.assets.doorfx_tex.wrapS=THREE.RepeatWrapping,new THREE.ShaderMaterial({uniforms:{time:{value:0},selected:{value:0},tex:{value:e.assets.doorfx_tex}},vertexShader:e.shaders.basic_vert,fragmentShader:e.shaders.door_frag})}(e),he.getObjectByName("door").material=de,he.getObjectByName("teleport").visible=!1}function Me(e){e.renderer.setClearColor(0),e.scene.add(he),e.camera.position.set(0,1.6,2)}function Ae(e){e.scene.remove(he)}function He(e,t,r){de.uniforms.time.value=r}var Le,Pe,Be,Oe,Ie,Ce,De=null;function je(e){const t=e.assets;var r=t.checkboard_tex;r.wrapS=THREE.RepeatWrapping,r.wrapT=THREE.RepeatWrapping;var n=t.vertigo_lm_tex;n.encoding=THREE.sRGBEncoding,n.flipY=!1;const o=new THREE.MeshBasicMaterial({color:16777215,map:r,lightMap:n});(De=t.vertigo_model.scene).traverse(e=>{"Mesh"==e.type&&(e.material=o)})}function Ue(e){e.renderer.setClearColor(6782887),e.scene.add(De),e.scene.parent.fog=new THREE.FogExp2(6782887,.004)}function Fe(e){e.scene.remove(De),e.scene.parent.fog=null}function ke(e,t,r){}const Ne=["bells","horn","cowbell","guiro","mandolin","squeaker","train","whistle","motorhorn","surdo","trumpet"];var Ge={};Ne.forEach(e=>{Ge[e]={animations:[],mesh:null,player:null,shadow:null}});const $e=5;var Ve=$e-1;function Ye(e){const t=e.assets;Le=t.sound_model.scene,Ie=t.sound_door_model.scene,t.sound_door_lm_tex.encoding=THREE.sRGBEncoding,t.sound_door_lm_tex.flipY=!1,Ie.getObjectByName("door_frame").material=new THREE.MeshBasicMaterial({map:t.sound_door_lm_tex}),Ce=function(e){return e.assets.doorfx_tex.wrapT=THREE.RepeatWrapping,e.assets.doorfx_tex.wrapS=THREE.RepeatWrapping,new THREE.ShaderMaterial({uniforms:{time:{value:0},selected:{value:0},tex:{value:e.assets.doorfx_tex}},vertexShader:e.shaders.basic_vert,fragmentShader:e.shaders.door_frag})}(e),Ie.getObjectByName("door").material=Ce,Ie.scale.set(.5,.5,.5),Ie.position.set(.4,.6,1),Ie.rotation.set(0,.4,0),Pe=new THREE.AudioListener,Oe=new THREE.AnimationMixer(Le);for(let e in Ge){const r=Le.getObjectByName(e);if(!r)continue;const n=new THREE.PositionalAudio(Pe);(new THREE.AudioLoader).load("assets/ogg/"+e+".ogg",e=>{n.setBuffer(e)}),Ge[e].player=n,Ge[e].mesh=r,r.visible=!1,r.add(n);const o=THREE.AnimationClip.findByName(t.sound_model.animations,e);if(o){const t=Oe.clipAction(o,r);t.loop=THREE.LoopOnce,Ge[e].animations.push(t)}for(let n=0;n<r.children.length;n++){const o=r.children[n],i=THREE.AnimationClip.findByName(t.sound_model.animations,`${e}_${o.name}`);if(!i)continue;const a=Oe.clipAction(i,r);a.loop=THREE.LoopOnce,Ge[e].animations.push(a)}let i=new THREE.Mesh(new THREE.PlaneBufferGeometry(3,3),new THREE.MeshBasicMaterial({color:r.children[0].material.color,map:t.sound_shadow_tex,transparent:!0,opacity:0,depthTest:!1,blending:THREE.AdditiveBlending}));i.position.set(r.position.x,.001,r.position.z),i.rotation.x=-Math.PI/2,Le.add(i),Ge[e].shadow=i}const r=new THREE.GridHelper(20,20,2236962,526344);Le.add(r)}var ze=-1;function Xe(){let e;if(ze>=0&&((e=Ge[Ne[ze]]).player.stop(),e.animations.length&&(e.mesh.visible=!1,e.animations.forEach(e=>{e.stop()}))),++Ve==$e){Ve=0;do{ze=(ze+1)%Ne.length,e=Ge[Ne[ze]]}while(!e.mesh)}e.player.play(),e.animations.length&&(e.mesh.visible=!0,e.animations.forEach(e=>{e.play()})),e.shadow.material.opacity=1,Be=setTimeout(Xe,2e3)}function We(e){e.renderer.setClearColor(0),e.scene.add(Le),e.scene.add(Ie),e.camera.add(Pe),e.camera.position.set(0,1.6,0),Be=setTimeout(Xe,2e3)}function Ke(e){e.scene.remove(Le),e.scene.remove(Ie),e.camera.remove(Pe),clearTimeout(Be)}function qe(e,t,r){Oe.update(t);const n=Ge[Ne[ze]];n&&n.shadow.material.opacity>0&&(n.shadow.material.opacity-=.5*t),Ce.uniforms.time.value=r}var Je={door_frag:"\nuniform float time;\nuniform float selected;\nuniform sampler2D tex;\nvarying vec2 vUv;\n\nvoid main( void ) {\n  float t = time;\n  vec2 uv = vUv * 2.0 - 1.0;\n  vec2 puv = vec2(length(uv.xy), atan(uv.x, uv.y));\n  vec4 col = texture2D(tex, vec2(log(puv.x) + t / 5.0, puv.y / 3.1415926 ));\n  float glow = (1.0 - puv.x) * (0.5 + (sin(t) + 2.0 ) / 4.0);\n  // blue glow\n  col += vec4(118.0/255.0, 144.0/255.0, 219.0/255.0, 1.0) * (0.4 + glow * 1.0);\n  // white glow\n  col += vec4(0.2) * smoothstep(0.0, 2.0, glow * glow);\n  gl_FragColor = col;\n\n}\n",ballfx_frag:"\nuniform float time;\nuniform sampler2D tex;\nvarying vec2 vUv;\nvarying vec3 vPosition;\nvarying vec3 vNormal;\n\n\nvoid main( void ) {\n  float t = time + vPosition.x + vPosition.z;\n  vec2 uv = vec2(vUv.x + t * 0.2, vUv.y + t);\n  vec4 col = texture2D(tex, uv);\n  col.a = 0.5 + sin(t * 5.0) * 0.3;\n\n  gl_FragColor = col;\n}\n",basic_vert:"\nvarying vec2 vUv;\nvarying vec3 vPosition;\nvoid main()\n{\n  vUv = uv;\n  vPosition = position;\n  vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);\n  gl_Position = projectionMatrix * mvPosition;\n}\n",panoball_vert:"\nvarying vec2 vUv;\nvarying vec3 vPosition;\nvarying vec3 vNormal;\nvarying vec3 vWorldPos;\nuniform float time;\n\nmat4 inverse(mat4 m) {\n  float\n      a00 = m[0][0], a01 = m[0][1], a02 = m[0][2], a03 = m[0][3],\n      a10 = m[1][0], a11 = m[1][1], a12 = m[1][2], a13 = m[1][3],\n      a20 = m[2][0], a21 = m[2][1], a22 = m[2][2], a23 = m[2][3],\n      a30 = m[3][0], a31 = m[3][1], a32 = m[3][2], a33 = m[3][3],\n\n      b00 = a00 * a11 - a01 * a10,\n      b01 = a00 * a12 - a02 * a10,\n      b02 = a00 * a13 - a03 * a10,\n      b03 = a01 * a12 - a02 * a11,\n      b04 = a01 * a13 - a03 * a11,\n      b05 = a02 * a13 - a03 * a12,\n      b06 = a20 * a31 - a21 * a30,\n      b07 = a20 * a32 - a22 * a30,\n      b08 = a20 * a33 - a23 * a30,\n      b09 = a21 * a32 - a22 * a31,\n      b10 = a21 * a33 - a23 * a31,\n      b11 = a22 * a33 - a23 * a32,\n\n      det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  return mat4(\n      a11 * b11 - a12 * b10 + a13 * b09,\n      a02 * b10 - a01 * b11 - a03 * b09,\n      a31 * b05 - a32 * b04 + a33 * b03,\n      a22 * b04 - a21 * b05 - a23 * b03,\n      a12 * b08 - a10 * b11 - a13 * b07,\n      a00 * b11 - a02 * b08 + a03 * b07,\n      a32 * b02 - a30 * b05 - a33 * b01,\n      a20 * b05 - a22 * b02 + a23 * b01,\n      a10 * b10 - a11 * b08 + a13 * b06,\n      a01 * b08 - a00 * b10 - a03 * b06,\n      a30 * b04 - a31 * b02 + a33 * b00,\n      a21 * b02 - a20 * b04 - a23 * b00,\n      a11 * b07 - a10 * b09 - a12 * b06,\n      a00 * b09 - a01 * b07 + a02 * b06,\n      a31 * b01 - a30 * b03 - a32 * b00,\n      a20 * b03 - a21 * b01 + a22 * b00) / det;\n}\n\n\nmat4 transpose(in mat4 m) {\n  vec4 i0 = m[0];\n  vec4 i1 = m[1];\n  vec4 i2 = m[2];\n  vec4 i3 = m[3];\n\n  return mat4(\n    vec4(i0.x, i1.x, i2.x, i3.x),\n    vec4(i0.y, i1.y, i2.y, i3.y),\n    vec4(i0.z, i1.z, i2.z, i3.z),\n    vec4(i0.w, i1.w, i2.w, i3.w)\n  );\n}\n\nvoid main()\n{\n  vUv = uv;\n\n  vec3 offset = vec3(\n    sin(position.x * 50.0 + time),\n    sin(position.y * 10.0 + time * 2.0),\n    cos(position.z * 40.0 + time)\n  ) * 0.003;\n\n  vNormal = normalize(inverse(transpose(modelMatrix)) * vec4(normalize(normal), 1.0)).xyz;\n  vWorldPos = (modelMatrix * vec4( position, 1.0 )).xyz;\n\n  vPosition = position;\n  vec4 mvPosition = modelViewMatrix * vec4(position + offset, 1.0);\n  gl_Position = projectionMatrix * mvPosition;\n}\n",ballfx_vert:"\nvarying vec2 vUv;\nvarying vec3 vPosition;\nvarying vec3 vNormal;\n\nvoid main()\n{\n  vUv = uv;\n\n  vNormal = normalize(normalMatrix * normal);\n\n  vPosition = position;\n  vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);\n  gl_Position = projectionMatrix * mvPosition;\n}\n",panoball_frag:"\nuniform sampler2D tex, texfx;\nuniform float time;\nvarying vec2 vUv;\nvarying vec3 vPosition;\nvarying vec3 vNormal;\nvarying vec3 vWorldPos;\n\n\nvoid main( void ) {\n  vec2 uv = vUv;\n  //uv.y =  1.0 - uv.y;\n\n  vec3 eye = normalize(cameraPosition - vWorldPos);\n  float fresnel = abs(dot(eye, vNormal));\n  float shift = pow((1.0 - fresnel), 4.0) * 0.05;\n\n  vec3 col = vec3(\n    texture2D(tex, uv - shift).r,\n    texture2D(tex, uv).g,\n    texture2D(tex, uv + shift).b\n  );\n\n  col = mix(col * 0.7, vec3(1.0), 0.7 - fresnel);\n\n  float t = time * 0.4 + vPosition.x + vPosition.z;\n  uv = vec2(vUv.x + t * 0.2, vUv.y + t);\n  vec3 fx = texture2D(texfx, uv).rgb * 0.4;\n\n\n  gl_FragColor = vec4(col + fx, 1.0);\n}\n"};r.d(t,"init",(function(){return ht}));var Ze,Qe,et,tt,rt,nt,ot,it,at=new THREE.Clock,st=[n,l,s,u,o,a];const ut=["hall","sound","photogrammetry","vertigo","panorama","panoramastereo"],lt=new URL(window.location).searchParams.get("stage");var ct=-1!==ut.indexOf(lt)?ut.indexOf(lt):0;console.log(`Current world "${ut[ct]}", ${ct}`);var pt={inter_bold_font:"fonts/Inter-Bold.font",inter_bold_tex:"fonts/Inter-Bold.png",inter_regular_font:"fonts/Inter-Regular.font",inter_regular_tex:"fonts/Inter-Regular.png",metropolis_bold_font:"fonts/Metropolis-Bold.font",metropolis_bold_tex:"fonts/Metropolis-Bold.png",hall_model:"hall.glb",vertigo_model:"vertigo2.gltf",generic_controller_model:"generic_controller.glb",lightmap_tex:"lightmap.png",travertine_tex:"travertine.png",travertine2_tex:"travertine2.jpg",controller_tex:"controller.png",pano1:"zapporthorn.basis",pano1small:"zapporthorn_small.jpg",doorfx_tex:"doorfx.png",pano2small:"andes_small.jpg",panoballfx_tex:"ballfx.jpg",andesL:"andesL.jpg",andesR:"andesR.jpg",checkboard_tex:"checkboard.png",vertigo_lm_tex:"vertigo2_lm.jpg",sky_tex:"sky.png",clouds_tex:"clouds.png",sound_model:"sound.glb",sound_door_model:"sound_door.glb",sound_shadow_tex:"sound_shadow.png",sound_door_lm_tex:"sound_door_lm.png",pg_floor_tex:"travertine2.jpg",pg_floor_lm_tex:"pg_floor_lm.png",pg_door_lm_tex:"pg_door_lm.png",pg_object_tex:"angel.basis",pg_object_model:"angel.glb",pg_bg_tex:"pg_bg.jpg",pg_flare_tex:"flare.jpg",pg_panel_tex:"panel.jpg",painting_seurat_tex:"paintings/seurat.basis",painting_sorolla_tex:"paintings/sorolla.basis",painting_bosch_tex:"paintings/bosch.basis",painting_degas_tex:"paintings/degas.basis",painting_rembrandt_tex:"paintings/rembrandt.basis"};function ft(e){st[ct].exit(nt),st[ct=e].enter(nt)}function ht(){Ze=new THREE.Scene,(tt=new THREE.PerspectiveCamera(80,window.innerWidth/window.innerHeight,.005,1e4)).position.set(0,1.6,0),tt.position.set(1.5,1.6,2.3),rt=new THREE.PointerLockControls(tt),document.body.addEventListener("click",()=>rt.lock()),document.body.addEventListener("keydown",e=>{switch(e.keyCode){case 87:rt.moveForward(.2);break;case 65:rt.moveRight(-.2);break;case 83:rt.moveForward(-.2);break;case 68:rt.moveRight(.2);break;case 78:ft((ct+1)%st.length);break;default:var t=e.keyCode-48;!e.metaKey&&t>=0&&t<st.length&&ft(t)}}),Ze.add(rt.getObject()),Qe=new THREE.Object3D,Ze.add(Qe),(et=new THREE.WebGLRenderer({antialias:!0,logarithmicDepthBuffer:!1})).gammaOutput=!0,et.gammaFactor=2.2,et.setPixelRatio(window.devicePixelRatio),et.setSize(window.innerWidth,window.innerHeight),et.vr.enabled=!0,window.addEventListener("resize",gt,!1),setInterval(()=>{console.log("render calls:",et.info.render.calls)},2e3),(ot=et.vr.getController(0)).addEventListener("selectstart",dt),ot.addEventListener("selectend",mt),it=et.vr.getController(1),ot.raycaster=new THREE.Raycaster,ot.raycaster.near=.1,it.raycaster=new THREE.Raycaster,it.raycaster.near=.1,it.addEventListener("selectstart",dt),it.addEventListener("selectend",mt);var e=new THREE.Group;e.add(tt),e.add(ot),e.add(it),Ze.add(e),nt={assets:pt,shaders:Je,scene:Qe,renderer:et,camera:tt,cameraRig:e,controllers:[ot,it],message:{text:"",data:null}},window.ctx=nt,function(e,t,r,n){t&&"/"!=t[t.length-1]&&(t+="/");var o=new THREE.BasisTextureLoader;o.setTranscoderPath(p),o.detectSupport(e);var i=new THREE.TextureLoader,a=new THREE.GLTFLoader,s={gltf:a,glb:a,obj:new THREE.OBJLoader,gif:i,png:i,jpg:i,basis:o,font:new THREE.FontLoader};for(var u in r){let e=u,o=r[u],i=o.substr(o.lastIndexOf(".")+1).toLowerCase();s[i].load(t+o,t=>{console.info(`%c ${o} loaded`,"color:green"),r[e]="font"==i?t.data:t,n&&f(r)&&n()})}}(et,"../assets/",pt,()=>{!function(){var e=pt.generic_controller_model.scene,t=new THREE.MeshLambertMaterial({map:pt.controller_tex});e.getObjectByName("body").material=t,e.getObjectByName("trigger").material=t,ot.add(e),it.add(e.clone()),ot.boundingBox=new THREE.Box3,it.boundingBox=new THREE.Box3,ot.grabbing=null,it.grabbing=null}(),oe(nt),ve(nt),we(nt),Se(nt),je(nt),Ye(nt),st[ct].enter(nt),document.body.appendChild(et.domElement),document.body.appendChild(c.createButton(et)),et.setAnimationLoop(vt)})}function dt(e){e.target.getObjectByName("trigger").rotation.x=-.3}function mt(e){e.target.getObjectByName("trigger").rotation.x=0}function gt(){tt.aspect=window.innerWidth/window.innerHeight,tt.updateProjectionMatrix(),et.setSize(window.innerWidth,window.innerHeight)}function vt(){var e=at.getDelta(),t=at.elapsedTime;if(nt.goto=null,nt.message={text:"",data:null},ot.boundingBox.setFromObject(ot.children[0]),it.boundingBox.setFromObject(it.children[0]),st[ct].execute(nt,e,t),et.render(Ze,tt),null!==nt.goto)switch(nt.goto){case"hall":ft(0);break;case"panorama0":ft(6);break;case"panorama1":ft(7)}}window.onload=()=>{ht()}}]);
//# sourceMappingURL=bundle.js.map